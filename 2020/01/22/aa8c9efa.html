<!DOCTYPE html><html lang="[&quot;zh-Hans&quot;,&quot;en&quot;,&quot;default&quot;]"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="åˆ†æSpringçš„BeanPostProcessor"><meta name="keywords" content="Spring, IOC, BeanPostProcessor"><meta name="author" content="ğŸ³Antä¸¶"><meta name="copyright" content="ğŸ³Antä¸¶"><title>IOCä¹‹æ·±å…¥åˆ†æBeanPostProcessor | BLOG | CAYZLH</title><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/cayzlh/psychic-potato@master/logo/favicon.ico"><link rel="stylesheet" href="/blog/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-129095667-1', 'auto');
ga('send', 'pageview');</script><meta name="google-site-verification" content="VrcbMTVpFGlHkIERHBt753dAtXKF4qirjnDweuXSRJw"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://v1.hitokoto.cn/?encode=js&amp;charset=utf-8&amp;select=.footer_custom_text" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/blog/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹:${query}"}},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  hexoVersion: '5.4.0'
} </script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/blog/atom.xml" title="BLOG | CAYZLH" type="application/atom+xml">
</head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="åˆ‡æ¢æ–‡ç« è¯¦æƒ…">åˆ‡æ¢ç«™ç‚¹æ¦‚è§ˆ</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">ç›®å½•</div><div class="sidebar-toc__progress"><span class="progress-notice">ä½ å·²ç»è¯»äº†</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#BeanPostProcessor-%E5%AE%9E%E4%BE%8B"><span class="toc-text">BeanPostProcessor å®ä¾‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BeanPostProcessor-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86"><span class="toc-text">BeanPostProcessor åŸºæœ¬åŸç†</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://cdn.jsdelivr.net/gh/cayzlh/psychic-potato@master/image/IMG_4207.JPG"></div><div class="author-info__name text-center">ğŸ³Antä¸¶</div><div class="author-info__description text-center">CODE IS POETRY</div><div class="follow-button"><a target="_blank" rel="external nofollow noopener noreferrer" href="https://telegram.me/Q2F5emxo">contact me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/blog/archives"><span class="pull-left">æ–‡ç« </span><span class="pull-right">98</span></a><!--if site.tags.length--><!--  a(href=url_for(config.tag_dir)).author-info-articles__tags.article-meta--><!--    span.pull-left= _p('sidebar.tags')--><!--    span.pull-right= site.tags.length--><!--if site.categories.length--><!--  a(href=url_for(config.category_dir)).author-info-articles__categories.article-meta--><!--    span.pull-left= _p('sidebar.categories')--><!--    span.pull-right= site.categories.length--><a class="author-info-articles__categories article-meta" href="/blog/categories/%E4%B9%A6%E7%B1%8D/%E3%80%8A%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E3%80%8B/"><span class="pull-left">ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹</span><span class="pull-right">âˆš</span></a><a class="author-info-articles__categories article-meta" href="/blog/categories/%E4%B9%A6%E7%B1%8D/%E3%80%8AMyBatis%E6%8A%80%E6%9C%AF%E5%86%85%E5%B9%95%E3%80%8B/"><span class="pull-left">ã€ŠMyBatisæŠ€æœ¯å†…å¹•ã€‹</span><span class="pull-right">âˆš</span></a><a class="author-info-articles__categories article-meta" href="/blog/categories/Java/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><span class="pull-left">Javaè®¾è®¡æ¨¡å¼</span><span class="pull-right">âˆš</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/blog/">BLOG | CAYZLH</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> æœç´¢</span></a></span></div><div id="post-info"><div id="post-title">IOCä¹‹æ·±å…¥åˆ†æBeanPostProcessor</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-01-22</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/blog/categories/Spring/">Spring</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/blog/categories/Spring/%E3%80%8ASpring%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%8B/">ã€ŠSpringæºç åˆ†æã€‹</a><div class="post-meta-wordcount"><span>å­—æ•°æ€»è®¡: </span><span class="word-count">2.2k</span><span class="post-meta__separator">|</span><span>é˜…è¯»æ—¶é•¿: 8 åˆ†é’Ÿ</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><blockquote>
<p>æœ¬æ–‡ä½œè€…ï¼šchenssy</p>
<p>å‡ºå¤„ï¼š<a target="_blank" rel="external nofollow noopener noreferrer" href="http://cmsblogs.com/?p=3338">http://cmsblogs.com/?p=3338</a></p>
<p>åœ¨å­¦ä¹ <code>Springæºç </code>çš„è¿‡ç¨‹ä¸­å‘ç°çš„å¥½ç«™+å¥½è´´ï¼Œæ„Ÿè°¢ä½œè€…ã€‚Springç‰ˆæœ¬ï¼š<strong>Spring 5.0.6.RELEASE</strong></p>
</blockquote>
<p>Spring ä½œä¸ºä¼˜ç§€çš„å¼€æºæ¡†æ¶ï¼Œå®ƒä¸ºæˆ‘ä»¬æä¾›äº†ä¸°å¯Œçš„å¯æ‰©å±•ç‚¹ï¼Œé™¤äº†å‰é¢æåˆ°çš„ Aware æ¥å£ï¼Œè¿˜åŒ…æ‹¬å…¶ä»–éƒ¨åˆ†ï¼Œå…¶ä¸­ä¸€ä¸ªå¾ˆé‡è¦çš„å°±æ˜¯ BeanPostProcessorã€‚</p>
<p>è¿™ç¯‡æ–‡ç« ä¸»è¦ä»‹ç» BeanPostProcessor çš„ä½¿ç”¨ä»¥åŠå…¶å®ç°åŸç†ã€‚æˆ‘ä»¬å…ˆçœ‹ BeanPostProcessor çš„å®šä½ï¼š</p>
<blockquote>
<p>BeanPostProcessor çš„ä½œç”¨ï¼šåœ¨ Bean å®Œæˆå®ä¾‹åŒ–åï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œä¸€äº›é…ç½®ã€å¢åŠ ä¸€äº›è‡ªå·±çš„å¤„ç†é€»è¾‘ï¼Œé‚£ä¹ˆè¯·ä½¿ç”¨ BeanPostProcessorã€‚</p>
</blockquote>
<h2 id="BeanPostProcessor-å®ä¾‹"><a href="#BeanPostProcessor-å®ä¾‹" class="headerlink" title="BeanPostProcessor å®ä¾‹"></a>BeanPostProcessor å®ä¾‹</h2><p>é¦–å…ˆå®šä¹‰ä¸€ä¸ªç±»ï¼Œè¯¥ç±»å®ç° BeanPostProcessor æ¥å£ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanPostProcessorTest</span> <span class="keyword">implements</span> <span class="title">BeanPostProcessor</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">postProcessBeforeInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Bean [&quot;</span> + beanName + <span class="string">&quot;] å¼€å§‹åˆå§‹åŒ–&quot;</span>);</span><br><span class="line">        <span class="comment">// è¿™é‡Œä¸€å®šè¦è¿”å› beanï¼Œä¸èƒ½è¿”å› null</span></span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">postProcessAfterInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Bean [&quot;</span> + beanName + <span class="string">&quot;] å®Œæˆåˆå§‹åŒ–&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;hello BeanPostProcessor!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ClassPathResource resource = <span class="keyword">new</span> ClassPathResource(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">DefaultListableBeanFactory factory = <span class="keyword">new</span> DefaultListableBeanFactory();</span><br><span class="line">XmlBeanDefinitionReader reader = <span class="keyword">new</span> XmlBeanDefinitionReader(factory);</span><br><span class="line">reader.loadBeanDefinitions(resource);</span><br><span class="line"></span><br><span class="line">BeanPostProcessorTest test = (BeanPostProcessorTest) factory.getBean(<span class="string">&quot;beanPostProcessorTest&quot;</span>);</span><br><span class="line">test.display();</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="https://gitee.com/cayzlh/img-repo/raw/master/2020/05/25/201808221005_JdCfC6.png" alt="201808221005"></p>
<p>è¿è¡Œç»“æœæ¯”è¾ƒå¥‡æ€ªï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰æ‰§è¡Œ <code>postProcessBeforeInitialization()</code> å’Œ <code>postProcessAfterInitialization()</code> å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬ debug è·Ÿè¸ªä¸‹ä»£ç ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•åœ¨ <code>initializeBean()</code> æ–¹æ³•å¤„è°ƒç”¨ä¸‹ï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="https://gitee.com/cayzlh/img-repo/raw/master/2020/05/25/201808221006_MDs9T9_IIu6YA.png" alt="201808221006"></p>
<p>debugï¼Œåœ¨ <code>postProcessBeforeInitialization()</code>æ–¹æ³•ä¸­ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://gitee.com/cayzlh/img-repo/raw/master/2020/05/25/15349468564658_aWOjeh_jNYP3X.jpg" alt="img"></p>
<p>è¿™æ®µä»£ç æ˜¯é€šè¿‡è¿­ä»£ <code>getBeanPostProcessors()</code> è¿”å›çš„ç»“æœé›†æ¥è°ƒç”¨ <code>postProcessBeforeInitialization()</code>ï¼Œä½†æ˜¯åœ¨è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°è¯¥æ–¹æ³•è¿”å›çš„ç»“æœé›†ä¸ºç©ºï¼Œæ‰€ä»¥è‚¯å®šä¸ä¼šæ‰§è¡Œç›¸åº”çš„ <code>postProcessBeforeInitialization()</code> æ–¹æ³•å’¯ã€‚æ€ä¹ˆåŠï¼Ÿ</p>
<p>ç­”æ¡ˆä¸è¨€è€Œå–»ï¼šåªéœ€è¦ <code>getBeanPostProcessors()</code> è¿”å›çš„ç»“æœé›†ä¸­å­˜åœ¨è‡³å°‘ä¸€ä¸ªå…ƒç´ å³å¯ï¼Œè¯¥æ–¹æ³•å®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;BeanPostProcessor&gt; <span class="title">getBeanPostProcessors</span><span class="params">()</span> </span>&#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="keyword">this</span>.beanPostProcessors;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿”å›çš„ beanPostProcessors æ˜¯ä¸€ä¸ª private çš„ List ï¼Œä¹Ÿå°±æ˜¯è¯´åªè¦è¯¥ç±»ä¸­å­˜åœ¨ <code>beanPostProcessors.add()</code> çš„è°ƒç”¨æˆ‘ä»¬å°±æ‰¾åˆ°äº†å…¥å£ï¼Œåœ¨ç±» AbstractBeanFactory ä¸­æ‰¾åˆ°äº†å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addBeanPostProcessor</span><span class="params">(BeanPostProcessor beanPostProcessor)</span> </span>&#123;</span><br><span class="line"> Assert.notNull(beanPostProcessor, <span class="string">&quot;BeanPostProcessor must not be null&quot;</span>);</span><br><span class="line"> <span class="keyword">this</span>.beanPostProcessors.remove(beanPostProcessor);</span><br><span class="line"> <span class="keyword">this</span>.beanPostProcessors.add(beanPostProcessor);</span><br><span class="line"> <span class="keyword">if</span> (beanPostProcessor <span class="keyword">instanceof</span> InstantiationAwareBeanPostProcessor) &#123;</span><br><span class="line">  <span class="keyword">this</span>.hasInstantiationAwareBeanPostProcessors = <span class="keyword">true</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">if</span> (beanPostProcessor <span class="keyword">instanceof</span> DestructionAwareBeanPostProcessor) &#123;</span><br><span class="line">  <span class="keyword">this</span>.hasDestructionAwareBeanPostProcessors = <span class="keyword">true</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¯¥æ–¹æ³•æ˜¯ç”± AbstractBeanFactory çš„çˆ¶ç±» ConfigurableBeanFactory å®šä¹‰ï¼Œå®ƒçš„æ ¸å¿ƒæ„æ€å°±æ˜¯å°†æŒ‡å®š BeanPostProcessor æ³¨å†Œåˆ°è¯¥ BeanFactory åˆ›å»ºçš„ bean ä¸­ï¼ŒåŒæ—¶å®ƒæ˜¯æŒ‰ç…§æ’å…¥çš„é¡ºåºè¿›è¡Œæ³¨å†Œçš„ï¼Œå®Œå…¨å¿½ç•¥ Ordered æ¥å£æ‰€è¡¨è¾¾ä»»ä½•æ’åºè¯­ä¹‰ï¼ˆåœ¨ BeanPostProcessor ä¸­æˆ‘ä»¬æä¾›ä¸€ä¸ª Ordered é¡ºåºï¼Œè¿™ä¸ªåé¢è®²è§£ï¼‰ã€‚</p>
<p>åˆ°è¿™é‡Œåº”è¯¥å°±æ¯”è¾ƒç†Ÿæ‚‰äº†ï¼Œå…¶å®åªéœ€è¦æ˜¾ç¤ºè°ƒç”¨ <code>addBeanPostProcessor()</code> å°±å¯ä»¥äº†ï¼ŒåŠ å…¥å¦‚ä¸‹ä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">BeanPostProcessorTest beanPostProcessorTest = <span class="keyword">new</span> BeanPostProcessorTest();</span><br><span class="line">factory.addBeanPostProcessor(beanPostProcessorTest);</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="https://gitee.com/cayzlh/img-repo/raw/master/2020/05/25/15349479459608_naPbOK_jwAf6w.jpg" alt="img"></p>
<p>å…¶å®è¿˜æœ‰ä¸€ç§æ›´åŠ ç®€å•çš„æ–¹æ³•ï¼Œè¿™ä¸ªæˆ‘ä»¬åé¢å†è¯´ï¼Œå…ˆçœ‹ BeanPostProcessor çš„åŸç†ã€‚</p>
<h2 id="BeanPostProcessor-åŸºæœ¬åŸç†"><a href="#BeanPostProcessor-åŸºæœ¬åŸç†" class="headerlink" title="BeanPostProcessor åŸºæœ¬åŸç†"></a>BeanPostProcessor åŸºæœ¬åŸç†</h2><p>BeanPostProcessor æ¥å£å®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BeanPostProcessor</span> </span>&#123;</span><br><span class="line"> <span class="meta">@Nullable</span></span><br><span class="line"> <span class="function"><span class="keyword">default</span> Object <span class="title">postProcessBeforeInitialization</span><span class="params">(Object bean, String beanName)</span> </span></span><br><span class="line"><span class="function">   <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> bean;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="meta">@Nullable</span></span><br><span class="line"> <span class="function"><span class="keyword">default</span> Object <span class="title">postProcessAfterInitialization</span><span class="params">(Object bean, String beanName)</span></span></span><br><span class="line"><span class="function">   <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> bean;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>BeanPostProcessor å¯ä»¥ç†è§£ä¸ºæ˜¯ Spring çš„ä¸€ä¸ªå·¥å‚é’©å­ï¼ˆå…¶å® Spring æä¾›ä¸€ç³»åˆ—çš„é’©å­ï¼Œå¦‚ Aware ã€InitializingBeanã€DisposableBeanï¼‰ï¼Œå®ƒæ˜¯ Spring æä¾›çš„å¯¹è±¡å®ä¾‹åŒ–é˜¶æ®µå¼ºæœ‰åŠ›çš„æ‰©å±•ç‚¹ï¼Œå…è®¸ Spring åœ¨å®ä¾‹åŒ– bean é˜¶æ®µå¯¹å…¶è¿›è¡Œå®šåˆ¶åŒ–ä¿®æ”¹ï¼Œæ¯”è¾ƒå¸¸è§çš„ä½¿ç”¨åœºæ™¯æ˜¯å¤„ç†æ ‡è®°æ¥å£å®ç°ç±»æˆ–è€…ä¸ºå½“å‰å¯¹è±¡æä¾›ä»£ç†å®ç°ï¼ˆä¾‹å¦‚AOPï¼‰ã€‚</p>
<p>ä¸€èˆ¬æ™®é€šçš„ BeanFactory æ˜¯ä¸æ”¯æŒè‡ªåŠ¨æ³¨å†Œ BeanPostProcessor çš„ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨è°ƒç”¨ <code>addBeanPostProcessor()</code> è¿›è¡Œæ³¨å†Œï¼Œæ³¨å†Œåçš„ BeanPostProcessor é€‚ç”¨äºæ‰€æœ‰è¯¥ BeanFactory åˆ›å»ºçš„ beanï¼Œä½†æ˜¯ ApplicationContext å¯ä»¥åœ¨å…¶ bean å®šä¹‰ä¸­è‡ªåŠ¨æ£€æµ‹æ‰€æœ‰çš„ BeanPostProcessor å¹¶è‡ªåŠ¨å®Œæˆæ³¨å†Œï¼ŒåŒæ—¶å°†ä»–ä»¬åº”ç”¨åˆ°éšååˆ›å»ºçš„ä»»ä½• bean ä¸­ã€‚</p>
<p><code>postProcessBeforeInitialization()</code> å’Œ <code>postProcessAfterInitialization()</code> ä¸¤ä¸ªæ–¹æ³•éƒ½æ¥æ”¶ä¸€ä¸ª Object ç±»å‹çš„ beanï¼Œä¸€ä¸ª String ç±»å‹çš„ beanNameï¼Œå…¶ä¸­ bean æ˜¯å·²ç»å®ä¾‹åŒ–äº†çš„ instanceBeanï¼Œèƒ½æ‹¿åˆ°è¿™ä¸ªä½ æ˜¯ä¸æ˜¯å¯ä»¥å¯¹å®ƒä¸ºæ‰€æ¬²ä¸ºäº†ï¼Ÿ è¿™ä¸¤ä¸ªæ–¹æ³•æ˜¯åˆå§‹åŒ– bean çš„å‰åç½®å¤„ç†å™¨ï¼Œä»–ä»¬åº”ç”¨ <code>invokeInitMethods()</code> å‰åã€‚å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://gitee.com/cayzlh/img-repo/raw/master/2020/05/25/201808231001_GnvpHv_yyK7tM.png" alt="201808231001"></p>
<p>ä»£ç å±‚æ¬¡ä¸Šé¢å·²ç»è´´å‡ºæ¥ï¼Œè¿™é‡Œå†è´´ä¸€æ¬¡ï¼š</p>
<p><img src="https://gitee.com/cayzlh/img-repo/raw/master/2020/05/25/201808221006_MDs9T9-20200525100713002_HB4JRD.png" alt="201808221006"></p>
<p>ä¸¤è€…æºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">applyBeanPostProcessorsBeforeInitialization</span><span class="params">(Object existingBean, String beanName)</span></span></span><br><span class="line"><span class="function">  <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line"></span><br><span class="line"> Object result = existingBean;</span><br><span class="line"> <span class="keyword">for</span> (BeanPostProcessor beanProcessor : getBeanPostProcessors()) &#123;</span><br><span class="line">  Object current = beanProcessor.postProcessBeforeInitialization(result, beanName);</span><br><span class="line">  <span class="keyword">if</span> (current == <span class="keyword">null</span>) &#123;</span><br><span class="line">   <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">  result = current;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">applyBeanPostProcessorsAfterInitialization</span><span class="params">(Object existingBean, String beanName)</span></span></span><br><span class="line"><span class="function">  <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line"></span><br><span class="line"> Object result = existingBean;</span><br><span class="line"> <span class="keyword">for</span> (BeanPostProcessor beanProcessor : getBeanPostProcessors()) &#123;</span><br><span class="line">  Object current = beanProcessor.postProcessAfterInitialization(result, beanName);</span><br><span class="line">  <span class="keyword">if</span> (current == <span class="keyword">null</span>) &#123;</span><br><span class="line">   <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">  result = current;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>getBeanPostProcessors()</code> è¿”å›çš„æ˜¯ beanPostProcessors é›†åˆï¼Œè¯¥é›†åˆé‡Œé¢å­˜æ”¾å°±æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„ BeanPostProcessorï¼Œå¦‚æœè¯¥é›†åˆä¸­å­˜åœ¨å…ƒç´ åˆ™è°ƒç”¨ç›¸åº”çš„æ–¹æ³•ï¼Œå¦åˆ™å°±ç›´æ¥è¿”å› bean äº†ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä½¿ç”¨ BeanFactory å®¹å™¨æ˜¯æ— æ³•è¾“å‡ºè‡ªå®šä¹‰ BeanPostProcessor é‡Œé¢çš„å†…å®¹ï¼Œå› ä¸ºåœ¨ <code>BeanFactory.getBean()</code> çš„è¿‡ç¨‹ä¸­æ ¹æœ¬å°±æ²¡æœ‰å°†æˆ‘ä»¬è‡ªå®šä¹‰çš„ BeanPostProcessor æ³¨å…¥è¿›æ¥ï¼Œæ‰€ä»¥è¦æƒ³ BeanFactory å®¹å™¨ çš„ BeanPostProcessor ç”Ÿæ•ˆæˆ‘ä»¬å¿…é¡»æ‰‹åŠ¨è°ƒç”¨ <code>addBeanPostProcessor()</code> å°†å®šä¹‰çš„ BeanPostProcessor æ³¨å†Œåˆ°ç›¸åº”çš„ BeanFactory ä¸­ã€‚ä½†æ˜¯ ApplicationContext ä¸éœ€è¦æ‰‹åŠ¨ï¼Œå› ä¸º ApplicationContext ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶å®Œæˆæ³¨å†Œã€‚</p>
<p>ApplicationContext å®ç°è‡ªåŠ¨æ³¨å†Œçš„åŸå› åœ¨äºæˆ‘ä»¬æ„é€ ä¸€ä¸ª ApplicationContext å®ä¾‹å¯¹è±¡çš„æ—¶å€™ä¼šè°ƒç”¨ <code>registerBeanPostProcessors()</code> æ–¹æ³•å°†æ£€æµ‹åˆ°çš„ BeanPostProcessor æ³¨å…¥åˆ° ApplicationContext å®¹å™¨ä¸­ï¼ŒåŒæ—¶åº”ç”¨åˆ°è¯¥å®¹å™¨åˆ›å»ºçš„ bean ä¸­ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å®ä¾‹åŒ–å¹¶è°ƒç”¨å·²ç»æ³¨å…¥çš„ BeanPostProcessor</span></span><br><span class="line"><span class="comment">     * å¿…é¡»åœ¨åº”ç”¨ä¸­ bean å®ä¾‹åŒ–ä¹‹å‰è°ƒç”¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">registerBeanPostProcessors</span><span class="params">(ConfigurableListableBeanFactory beanFactory)</span> </span>&#123;</span><br><span class="line">  PostProcessorRegistrationDelegate.registerBeanPostProcessors(beanFactory, <span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">registerBeanPostProcessors</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  ConfigurableListableBeanFactory beanFactory, AbstractApplicationContext applicationContext)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è·å–æ‰€æœ‰çš„ BeanPostProcessor çš„ beanName</span></span><br><span class="line">  <span class="comment">// è¿™äº› beanName éƒ½å·²ç»å…¨éƒ¨åŠ è½½åˆ°å®¹å™¨ä¸­å»ï¼Œä½†æ˜¯æ²¡æœ‰å®ä¾‹åŒ–</span></span><br><span class="line">  String[] postProcessorNames = beanFactory.getBeanNamesForType(BeanPostProcessor.class, <span class="keyword">true</span>, <span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è®°å½•æ‰€æœ‰çš„beanProcessoræ•°é‡</span></span><br><span class="line">  <span class="keyword">int</span> beanProcessorTargetCount = beanFactory.getBeanPostProcessorCount() + <span class="number">1</span> + postProcessorNames.length;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ³¨å†Œ BeanPostProcessorCheckerï¼Œå®ƒä¸»è¦æ˜¯ç”¨äºåœ¨ BeanPostProcessor å®ä¾‹åŒ–æœŸé—´è®°å½•æ—¥å¿—</span></span><br><span class="line">  <span class="comment">// å½“ Spring ä¸­é«˜é…ç½®çš„åç½®å¤„ç†å™¨è¿˜æ²¡æœ‰æ³¨å†Œå°±å·²ç»å¼€å§‹äº† bean çš„å®ä¾‹åŒ–è¿‡ç¨‹ï¼Œè¿™ä¸ªæ—¶å€™ä¾¿ä¼šæ‰“å° BeanPostProcessorChecker ä¸­çš„å†…å®¹</span></span><br><span class="line">  beanFactory.addBeanPostProcessor(<span class="keyword">new</span> PostProcessorRegistrationDelegate.BeanPostProcessorChecker(beanFactory, beanProcessorTargetCount));</span><br><span class="line"></span><br><span class="line">  <span class="comment">// PriorityOrdered ä¿è¯é¡ºåº</span></span><br><span class="line">  List&lt;BeanPostProcessor&gt; priorityOrderedPostProcessors = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">  <span class="comment">// MergedBeanDefinitionPostProcessor</span></span><br><span class="line">  List&lt;BeanPostProcessor&gt; internalPostProcessors = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">  <span class="comment">// ä½¿ç”¨ Ordered ä¿è¯é¡ºåº</span></span><br><span class="line">  List&lt;String&gt; orderedPostProcessorNames = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">  <span class="comment">// æ²¡æœ‰é¡ºåº</span></span><br><span class="line">  List&lt;String&gt; nonOrderedPostProcessorNames = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">  <span class="keyword">for</span> (String ppName : postProcessorNames) &#123;</span><br><span class="line">    <span class="comment">// PriorityOrdered</span></span><br><span class="line">    <span class="keyword">if</span> (beanFactory.isTypeMatch(ppName, PriorityOrdered.class)) &#123;</span><br><span class="line">      <span class="comment">// è°ƒç”¨ getBean è·å– bean å®ä¾‹å¯¹è±¡</span></span><br><span class="line">      BeanPostProcessor pp = beanFactory.getBean(ppName, BeanPostProcessor.class);</span><br><span class="line">      priorityOrderedPostProcessors.add(pp);</span><br><span class="line">      <span class="keyword">if</span> (pp <span class="keyword">instanceof</span> MergedBeanDefinitionPostProcessor) &#123;</span><br><span class="line">        internalPostProcessors.add(pp);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Ordered</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (beanFactory.isTypeMatch(ppName, Ordered.class)) &#123;</span><br><span class="line">      orderedPostProcessorNames.add(ppName);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// æ— åº</span></span><br><span class="line">      nonOrderedPostProcessorNames.add(ppName);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç¬¬ä¸€æ­¥æ³¨å†Œæ‰€æœ‰å®ç°äº† PriorityOrdered çš„BeanPostProcessor</span></span><br><span class="line">  <span class="comment">// å…ˆæ’åº</span></span><br><span class="line">  sortPostProcessors(priorityOrderedPostProcessors, beanFactory);</span><br><span class="line">  <span class="comment">// åæ³¨å†Œ</span></span><br><span class="line">  registerBeanPostProcessors(beanFactory, priorityOrderedPostProcessors);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç¬¬äºŒæ­¥æ³¨å†Œæ‰€æœ‰å®ç°äº† Ordered çš„ BeanPostProcessor</span></span><br><span class="line">  List&lt;BeanPostProcessor&gt; orderedPostProcessors = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">  <span class="keyword">for</span> (String ppName : orderedPostProcessorNames) &#123;</span><br><span class="line">    BeanPostProcessor pp = beanFactory.getBean(ppName, BeanPostProcessor.class);</span><br><span class="line">    orderedPostProcessors.add(pp);</span><br><span class="line">    <span class="keyword">if</span> (pp <span class="keyword">instanceof</span> MergedBeanDefinitionPostProcessor) &#123;</span><br><span class="line">      internalPostProcessors.add(pp);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  sortPostProcessors(orderedPostProcessors, beanFactory);</span><br><span class="line">  registerBeanPostProcessors(beanFactory, orderedPostProcessors);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç¬¬ä¸‰æ­¥æ³¨å†Œæ‰€æœ‰æ— åºçš„ BeanPostProcessor</span></span><br><span class="line">  List&lt;BeanPostProcessor&gt; nonOrderedPostProcessors = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">  <span class="keyword">for</span> (String ppName : nonOrderedPostProcessorNames) &#123;</span><br><span class="line">    BeanPostProcessor pp = beanFactory.getBean(ppName, BeanPostProcessor.class);</span><br><span class="line">    nonOrderedPostProcessors.add(pp);</span><br><span class="line">    <span class="keyword">if</span> (pp <span class="keyword">instanceof</span> MergedBeanDefinitionPostProcessor) &#123;</span><br><span class="line">      internalPostProcessors.add(pp);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  registerBeanPostProcessors(beanFactory, nonOrderedPostProcessors);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æœ€åï¼Œæ³¨å†Œæ‰€æœ‰çš„ MergedBeanDefinitionPostProcessor ç±»å‹çš„ BeanPostProcessor</span></span><br><span class="line">  sortPostProcessors(internalPostProcessors, beanFactory);</span><br><span class="line">  registerBeanPostProcessors(beanFactory, internalPostProcessors);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åŠ å…¥ApplicationListenerDetectorï¼ˆæ¢æµ‹å™¨ï¼‰</span></span><br><span class="line">  <span class="comment">// é‡æ–°æ³¨å†Œ BeanPostProcessor ä»¥æ£€æµ‹å†…éƒ¨ beanï¼Œå› ä¸º ApplicationListeners å°†å…¶ç§»åŠ¨åˆ°å¤„ç†å™¨é“¾çš„æœ«å°¾</span></span><br><span class="line">  beanFactory.addBeanPostProcessor(<span class="keyword">new</span> ApplicationListenerDetector(applicationContext));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•é¦–å…ˆ beanFactory è·å–æ³¨å†Œåˆ°è¯¥ BeanFactory ä¸­æ‰€æœ‰ BeanPostProcessor ç±»å‹çš„ beanNameï¼Œå…¶å®å°±æ˜¯æ‰¾æ‰€æœ‰å®ç°äº† BeanPostProcessor æ¥å£çš„ bean ï¼Œç„¶åè¿­ä»£è¿™äº› beanï¼Œå°†å…¶æŒ‰ç…§PriorityOrderedã€Orderedã€æ— åºçš„é¡ºåºæ·»åŠ è‡³ç›¸åº”çš„ List é›†åˆä¸­ï¼Œæœ€åä¾æ¬¡è°ƒç”¨ <code>sortPostProcessors()</code> è¿›è¡Œæ’åºå¤„ç†å’Œ <code>registerBeanPostProcessors()</code> å®Œæˆæ³¨å†Œã€‚æ’åºå¾ˆç®€å•ï¼Œå¦‚æœ beanFactory ä¸º DefaultListableBeanFactory åˆ™è¿”å› BeanFactory æ‰€ä¾èµ–çš„æ¯”è¾ƒå™¨ï¼Œå¦åˆ™åæ­£é»˜è®¤çš„æ¯”è¾ƒå™¨(OrderComparator)ï¼Œç„¶åè°ƒç”¨ <code>sort()</code> å³å¯ã€‚å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sortPostProcessors</span><span class="params">(List&lt;?&gt; postProcessors, ConfigurableListableBeanFactory beanFactory)</span> </span>&#123;</span><br><span class="line"> Comparator&lt;Object&gt; comparatorToUse = <span class="keyword">null</span>;</span><br><span class="line"> <span class="keyword">if</span> (beanFactory <span class="keyword">instanceof</span> DefaultListableBeanFactory) &#123;</span><br><span class="line">  comparatorToUse = ((DefaultListableBeanFactory) beanFactory).getDependencyComparator();</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">if</span> (comparatorToUse == <span class="keyword">null</span>) &#123;</span><br><span class="line">  comparatorToUse = OrderComparator.INSTANCE;</span><br><span class="line"> &#125;</span><br><span class="line"> postProcessors.sort(comparatorToUse);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è€Œå¯¹äºæ³¨å†ŒåŒæ ·æ˜¯è°ƒç”¨ <code>AbstractBeanFactory.addBeanPostProcessor()</code> æ–¹æ³•å®Œæˆæ³¨å†Œï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">registerBeanPostProcessors</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  ConfigurableListableBeanFactory beanFactory, List&lt;BeanPostProcessor&gt; postProcessors)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span> (BeanPostProcessor postProcessor : postProcessors) &#123;</span><br><span class="line">  beanFactory.addBeanPostProcessor(postProcessor);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è‡³æ­¤ï¼ŒBeanPostProcessor å·²ç»åˆ†æå®Œæ¯•äº†ï¼Œè¿™é‡Œç®€å•æ€»ç»“ä¸‹ï¼š</p>
<ol>
<li>BeanPostProcessor çš„ä½œç”¨åŸŸæ˜¯å®¹å™¨çº§åˆ«çš„ï¼Œå®ƒåªå’Œæ‰€åœ¨çš„å®¹å™¨ç›¸å…³ ï¼Œå½“ BeanPostProcessor å®Œæˆæ³¨å†Œåï¼Œå®ƒä¼šåº”ç”¨äºæ‰€æœ‰è·Ÿå®ƒåœ¨åŒä¸€ä¸ªå®¹å™¨å†…çš„ beanã€‚</li>
<li>BeanFactory å’Œ ApplicationContext å¯¹ BeanPostProcessor çš„å¤„ç†ä¸åŒï¼ŒApplicationContext ä¼šè‡ªåŠ¨æ£€æµ‹æ‰€æœ‰å®ç°äº† BeanPostProcessor æ¥å£çš„ beanï¼Œå¹¶å®Œæˆæ³¨å†Œï¼Œä½†æ˜¯ä½¿ç”¨ BeanFactory å®¹å™¨æ—¶åˆ™éœ€è¦æ‰‹åŠ¨è°ƒç”¨ <code>addBeanPostProcessor()</code> å®Œæˆæ³¨å†Œ</li>
<li>ApplicationContext çš„ BeanPostProcessor æ”¯æŒ Orderedï¼Œè€Œ BeanFactory çš„ BeanPostProcessor æ˜¯ä¸æ”¯æŒçš„ï¼ŒåŸå› åœ¨äºApplicationContext ä¼šå¯¹ BeanPostProcessor è¿›è¡Œ Ordered æ£€æµ‹å¹¶å®Œæˆæ’åºï¼Œè€Œ BeanFactory ä¸­çš„ BeanPostProcessor åªè·Ÿæ³¨å†Œçš„é¡ºåºæœ‰å…³ã€‚</li>
</ol>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined" rel="external nofollow noopener noreferrer" target="_blank">ğŸ³Antä¸¶</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://www.cayzlh.com/2020/01/22/aa8c9efa.html">https://www.cayzlh.com/2020/01/22/aa8c9efa.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" rel="external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://www.cayzlh.com">BLOG | CAYZLH</a>ï¼</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/blog/tags/Spring/">Spring</a><a class="post-meta__tags" href="/blog/tags/%E8%BD%AC%E8%BD%BD/">è½¬è½½</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/blog/2020/01/23/3af7524a.html"><i class="fa fa-chevron-left">  </i><span>IOCä¹‹æ·±å…¥åˆ†æInitializingBeanå’Œinit-method</span></a></div><div class="next-post pull-right"><a href="/blog/2020/01/22/26a31db5.html"><span>IOCä¹‹æ·±å…¥åˆ†æAwareæ¥å£</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="footer_custom_text">hitokoto</div><div class="copyright">ğŸ³Antä¸¶ &copy;2019 - 2021</div><div class="icp"><a><span>ç²¤ICPå¤‡20058712å·</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/blog/js/utils.js?version=1.9.0"></script><script src="/blog/js/fancybox.js?version=1.9.0"></script><script src="/blog/js/sidebar.js?version=1.9.0"></script><script src="/blog/js/copy.js?version=1.9.0"></script><script src="/blog/js/fireworks.js?version=1.9.0"></script><script src="/blog/js/transition.js?version=1.9.0"></script><script src="/blog/js/scroll.js?version=1.9.0"></script><script src="/blog/js/head.js?version=1.9.0"></script><script src="/blog/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« "></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>