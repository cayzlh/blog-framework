<!DOCTYPE html>
<html lang="en">
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="é˜…è¯»Springå®˜æ–¹æ–‡æ¡£ï¼Œæ¢³ç†ä¸€ä¸‹SpringAOPçŸ¥è¯†ç‚¹">
<meta property="og:type" content="article">
<meta property="og:title" content="Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰">
<meta property="og:url" content="https://www.cayzlh.com/">
<meta property="og:site_name" content="CAYZLH">
<meta property="og:description" content="é˜…è¯»Springå®˜æ–¹æ–‡æ¡£ï¼Œæ¢³ç†ä¸€ä¸‹SpringAOPçŸ¥è¯†ç‚¹">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/cayzlh/git-img-repository@master/uPic/20191118210559319.png">
<meta property="article:published_time" content="2020-03-31T03:03:22.000Z">
<meta property="article:modified_time" content="2020-06-22T01:29:06.066Z">
<meta property="article:author" content="ğŸ³Antä¸¶">
<meta property="article:tag" content="Spring">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/cayzlh/git-img-repository@master/uPic/20191118210559319.png">
    
    
      
        
          <link rel="shortcut icon" href="/blog/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/blog/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/blog/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/blog/css/rtl.css">

    
    <!-- rss -->
    
    
      <link rel="alternate" href="/blog/true" title="CAYZLH" type="application/atom+xml">
    
<meta name="generator" content="Hexo 5.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        
          <li><a href="/blog/">Home</a></li>
        
          <li><a href="/blog/archives/">Articles</a></li>
        
          <li><a href="/blog/about/">About</a></li>
        
          <li><a href="/blog/search/">Search</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/blog/2020/04/25/8802fffc.html"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/blog/2020/03/24/40c5d21f.html"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
<!--        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>-->
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous</span>
      <span id="i-next" class="info" style="display:none;">Next</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.facebook.com/sharer.php?u=https://www.cayzlh.com/2020/03/31/741621cd.html"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://twitter.com/share?url=https://www.cayzlh.com/2020/03/31/741621cd.html&text=Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.linkedin.com/shareArticle?url=https://www.cayzlh.com/2020/03/31/741621cd.html&title=Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://pinterest.com/pin/create/bookmarklet/?url=https://www.cayzlh.com/2020/03/31/741621cd.html&is_video=false&description=Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰&body=Check out this article: https://www.cayzlh.com/2020/03/31/741621cd.html"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://getpocket.com/save?url=https://www.cayzlh.com/2020/03/31/741621cd.html&title=Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://reddit.com/submit?url=https://www.cayzlh.com/2020/03/31/741621cd.html&title=Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.stumbleupon.com/submit?url=https://www.cayzlh.com/2020/03/31/741621cd.html&title=Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://digg.com/submit?url=https://www.cayzlh.com/2020/03/31/741621cd.html&title=Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.tumblr.com/share/link?url=https://www.cayzlh.com/2020/03/31/741621cd.html&name=Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://news.ycombinator.com/submitlink?u=https://www.cayzlh.com/2020/03/31/741621cd.html&t=Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring-AOP%E6%A6%82%E5%BF%B5"><span class="toc-number">1.</span> <span class="toc-text">Spring AOPæ¦‚å¿µ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#advice%E7%9A%84%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.1.</span> <span class="toc-text">adviceçš„å‡ ç§ç±»å‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AOP%E4%BB%A3%E7%90%86"><span class="toc-number">2.</span> <span class="toc-text">AOPä»£ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Spring-Bean%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">2.1.</span> <span class="toc-text">Spring Beançš„ç”Ÿå‘½å‘¨æœŸ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AOP%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">3.</span> <span class="toc-text">AOPçš„ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AspectJ%E4%B8%8E-AspectJ"><span class="toc-number">3.1.</span> <span class="toc-text">AspectJä¸@AspectJ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E7%94%A8-AspectJ%E6%94%AF%E6%8C%81"><span class="toc-number">3.2.</span> <span class="toc-text">å¯ç”¨@AspectJæ”¯æŒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E%E4%B8%80%E4%B8%AA%E5%88%87%E9%9D%A2"><span class="toc-number">3.3.</span> <span class="toc-text">å£°æ˜ä¸€ä¸ªåˆ‡é¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E%E5%88%87%E5%85%A5%E7%82%B9"><span class="toc-number">3.4.</span> <span class="toc-text">å£°æ˜åˆ‡å…¥ç‚¹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%AF%E6%8C%81%E7%9A%84%E5%88%87%E5%85%A5%E7%82%B9%E6%8C%87%E7%A4%BA%E7%AC%A6"><span class="toc-number">3.4.1.</span> <span class="toc-text">æ”¯æŒçš„åˆ‡å…¥ç‚¹æŒ‡ç¤ºç¬¦</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E5%88%87%E5%85%A5%E7%82%B9"><span class="toc-number">3.4.2.</span> <span class="toc-text">ç»„åˆåˆ‡å…¥ç‚¹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B1%E4%BA%AB%E9%80%9A%E7%94%A8%E5%88%87%E5%85%A5%E7%82%B9%E5%AE%9A%E4%B9%89"><span class="toc-number">3.4.3.</span> <span class="toc-text">å…±äº«é€šç”¨åˆ‡å…¥ç‚¹å®šä¹‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Examples"><span class="toc-number">3.4.4.</span> <span class="toc-text">Examples</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E%E9%80%9A%E7%9F%A5"><span class="toc-number">3.5.</span> <span class="toc-text">å£°æ˜é€šçŸ¥</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Before-Advice"><span class="toc-number">3.5.1.</span> <span class="toc-text">Before Advice</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#After-Returning-Advice"><span class="toc-number">3.5.2.</span> <span class="toc-text">After Returning Advice</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#After-Throwing-Advice"><span class="toc-number">3.5.3.</span> <span class="toc-text">After Throwing Advice</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#After-Finally-Advice"><span class="toc-number">3.5.4.</span> <span class="toc-text">After (Finally) Advice</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Around-Advice"><span class="toc-number">3.5.5.</span> <span class="toc-text">Around Advice</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E5%85%A5"><span class="toc-number">3.6.</span> <span class="toc-text">å¼•å…¥</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring-AOP%E5%AE%9E%E4%BE%8B"><span class="toc-number">4.</span> <span class="toc-text">Spring AOPå®ä¾‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">5.</span> <span class="toc-text">æ€»ç»“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">6.</span> <span class="toc-text">å‚è€ƒ</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">ğŸ³Antä¸¶</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-03-31T03:03:22.000Z" itemprop="datePublished">2020-03-31</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/blog/categories/Spring/">Spring</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/blog/tags/Spring/" rel="tag">Spring</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <blockquote>
<p>Aspect Oriented Programming with Spring</p>
<p>é¢å‘åˆ‡é¢çš„ç¼–ç¨‹ï¼ˆAOPï¼‰é€šè¿‡æä¾›å¦ä¸€ç§æ€è€ƒç¨‹åºç»“æ„çš„æ–¹å¼æ¥è¡¥å……é¢å‘å¯¹è±¡çš„ç¼–ç¨‹ï¼ˆOOPï¼‰ã€‚</p>
</blockquote>
<p> OOPä¸­æ¨¡å—åŒ–çš„å…³é”®å•å…ƒæ˜¯ç±»ï¼Œè€Œåœ¨AOPä¸­æ¨¡å—åŒ–æ˜¯æ–¹é¢ã€‚åˆ‡é¢ä½¿å…³æ³¨ç‚¹ï¼ˆä¾‹å¦‚äº‹åŠ¡ç®¡ç†ï¼‰çš„æ¨¡å—åŒ–è·¨è¶Šäº†å¤šä¸ªç±»å‹å’Œå¯¹è±¡ã€‚ ï¼ˆè¿™ç§å…³æ³¨åœ¨AOPæ–‡çŒ®ä¸­é€šå¸¸è¢«ç§°ä¸ºâ€œè·¨é¢†åŸŸâ€å…³æ³¨ã€‚ï¼‰</p>
<p>Springçš„å…³é”®ç»„ä»¶ä¹‹ä¸€æ˜¯AOPæ¡†æ¶ã€‚å°½ç®¡Spring IoCå®¹å™¨ä¸ä¾èµ–äºAOPï¼Œä½†<strong>AOPæ˜¯å¯¹Spring IoCçš„è¡¥å……ï¼Œå¯ä»¥æä¾›åŠŸèƒ½å¼ºå¤§çš„ä¸­é—´ä»¶è§£å†³æ–¹æ¡ˆã€‚</strong></p>
<blockquote>
<p>Spring AOP with AspectJ pointcuts</p>
<p>Spring provides simple and powerful ways of writing custom aspects by using either a <a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#aop-schema">schema-based approach</a> or the <a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#aop-ataspectj">@AspectJ annotation style</a>. Both of these styles offer fully typed advice and use of the AspectJ pointcut language while still using Spring AOP for weaving.</p>
<p>å…·æœ‰AspectJåˆ‡å…¥ç‚¹çš„Spring AOP<br>é€šè¿‡ä½¿ç”¨<strong>åŸºäºæ¨¡å¼çš„æ–¹æ³•</strong>æˆ–**@AspectJæ³¨è§£æ ·å¼**ï¼ŒSpringæä¾›äº†ç¼–å†™è‡ªå®šä¹‰åˆ‡é¢çš„ç®€å•è€Œå¼ºå¤§çš„æ–¹æ³•ã€‚è¿™ä¸¤ç§æ ·å¼éƒ½æä¾›äº†å®Œå…¨ç±»å‹åŒ–çš„å»ºè®®ï¼Œå¹¶ä½¿ç”¨äº†AspectJåˆ‡å…¥ç‚¹è¯­è¨€ï¼ŒåŒæ—¶ä»ç„¶ä½¿ç”¨Spring AOPè¿›è¡Œç¼–ç¨‹ã€‚</p>
</blockquote>
<h2 id="Spring-AOPæ¦‚å¿µ"><a href="#Spring-AOPæ¦‚å¿µ" class="headerlink" title="Spring AOPæ¦‚å¿µ"></a>Spring AOPæ¦‚å¿µ</h2><p>ä¸€äº›é‡è¦çš„AOPæ¦‚å¿µå’Œæœ¯è¯­ã€‚<em>è¿™äº›æœ¯è¯­ä¸æ˜¯ç‰¹å®šäºSpringçš„ã€‚</em></p>
<ul>
<li><p><strong>åˆ‡é¢ï¼ˆAspectï¼‰</strong></p>
<p>ç±»æ˜¯å¯¹ç‰©ä½“ç‰¹å¾çš„æŠ½è±¡ï¼Œ<em>åˆ‡é¢å°±æ˜¯å¯¹æ¨ªåˆ‡å…³æ³¨ç‚¹çš„æŠ½è±¡</em>ã€‚</p>
<blockquote>
<p>åœ¨Spring AOPä¸­ï¼Œåˆ‡é¢æ˜¯é€šè¿‡ä½¿ç”¨å¸¸è§„ç±»ï¼ˆåŸºäºæ¶æ„çš„æ–¹æ³•ï¼‰æˆ–ä½¿ç”¨@Aspectæ³¨é‡Šï¼ˆ@AspectJæ ·å¼ï¼‰æ³¨é‡Šçš„å¸¸è§„ç±»æ¥å®ç°çš„ã€‚</p>
</blockquote>
<p><code>aspect</code> ç”± <code>pointcount</code> å’Œ <code>advice</code> ç»„æˆ, å®ƒæ—¢åŒ…å«äº†æ¨ªåˆ‡é€»è¾‘çš„å®šä¹‰, ä¹ŸåŒ…æ‹¬äº†è¿æ¥ç‚¹çš„å®šä¹‰. Spring AOPå°±æ˜¯è´Ÿè´£å®æ–½åˆ‡é¢çš„æ¡†æ¶, å®ƒå°†åˆ‡é¢æ‰€å®šä¹‰çš„æ¨ªåˆ‡é€»è¾‘ç»‡å…¥åˆ°åˆ‡é¢æ‰€æŒ‡å®šçš„è¿æ¥ç‚¹ä¸­.<br>AOPçš„å·¥ä½œé‡å¿ƒåœ¨äºå¦‚ä½•å°†å¢å¼ºç»‡å…¥ç›®æ ‡å¯¹è±¡çš„è¿æ¥ç‚¹ä¸Š, è¿™é‡ŒåŒ…å«ä¸¤ä¸ªå·¥ä½œ:</p>
<ol>
<li>å¦‚ä½•é€šè¿‡ pointcut å’Œ advice å®šä½åˆ°ç‰¹å®šçš„ joinpoint ä¸Š</li>
<li>å¦‚ä½•åœ¨ advice ä¸­ç¼–å†™åˆ‡é¢ä»£ç .</li>
</ol>
</li>
<li><p><strong>è¿æ¥ç‚¹ï¼ˆJoin pointï¼‰</strong></p>
<blockquote>
<p>A point during the execution of a program, such as the execution of a method or the handling of an exception. In Spring AOP, a join point always represents a method execution.</p>
</blockquote>
<p>ç¨‹åºè¿è¡Œä¸­çš„ä¸€äº›æ—¶é—´ç‚¹ï¼Œä¾‹å¦‚ä¸€ä¸ªæ–¹æ³•çš„æ‰§è¡Œï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªå¼‚å¸¸çš„å¤„ç†ã€‚<br><code>åœ¨ Spring AOP ä¸­, join point æ€»æ˜¯æ–¹æ³•çš„æ‰§è¡Œç‚¹, å³åªæœ‰æ–¹æ³•è¿æ¥ç‚¹.</code></p>
</li>
<li><p><strong>å¢å¼ºï¼ˆAdviceï¼‰</strong></p>
<blockquote>
<p>Action taken by an aspect at a particular join point. Different types of advice include â€œaroundâ€, â€œbeforeâ€ and â€œafterâ€ advice. (Advice types are discussed later.) Many AOP frameworks, including Spring, model an advice as an interceptor and maintain a chain of interceptors around the join point.</p>
</blockquote>
<p>åˆ‡é¢åœ¨ç‰¹å®šçš„è¿æ¥ç‚¹å¤„é‡‡å–çš„æ“ä½œã€‚ä¸åŒç±»å‹çš„å»ºè®®åŒ…æ‹¬<code>around</code>ï¼Œ<code>before</code>å’Œ<code>after</code>é€šçŸ¥ã€‚ åŒ…æ‹¬Springåœ¨å†…çš„è®¸å¤šAOPæ¡†æ¶éƒ½å°†é€šçŸ¥å»ºæ¨¡ä¸ºæ‹¦æˆªå™¨ï¼Œå¹¶åœ¨è¿æ¥ç‚¹å‘¨å›´ç»´æŠ¤ä¸€ç³»åˆ—æ‹¦æˆªå™¨ã€‚</p>
<p>ç”± <code>aspect</code> æ·»åŠ åˆ°ç‰¹å®šçš„ join point(å³æ»¡è¶³ <code>point cut</code> è§„åˆ™çš„ join point) çš„ä¸€æ®µä»£ç .<br>è®¸å¤š <code>AOP</code>æ¡†æ¶, åŒ…æ‹¬ <code>Spring AOP</code>, ä¼šå°† <code>advice</code> æ¨¡æ‹Ÿä¸ºä¸€ä¸ªæ‹¦æˆªå™¨(<code>interceptor</code>), å¹¶ä¸”åœ¨ join point ä¸Šç»´æŠ¤å¤šä¸ª <code>advice</code>, è¿›è¡Œå±‚å±‚æ‹¦æˆª.<br><em>ä¾‹å¦‚ <code>HTTP</code> é‰´æƒçš„å®ç°, æˆ‘ä»¬å¯ä»¥ä¸ºæ¯ä¸ªä½¿ç”¨ <code>RequestMapping</code> æ ‡æ³¨çš„æ–¹æ³•ç»‡å…¥ <code>advice</code>, å½“ <code>HTTP</code> è¯·æ±‚åˆ°æ¥æ—¶, é¦–å…ˆè¿›å…¥åˆ° <code>advice</code> ä»£ç ä¸­, åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥åˆ†æè¿™ä¸ª <code>HTTP</code> è¯·æ±‚æ˜¯å¦æœ‰ç›¸åº”çš„æƒé™, å¦‚æœæœ‰, åˆ™æ‰§è¡Œ <code>Controller</code>, å¦‚æœæ²¡æœ‰, åˆ™æŠ›å‡ºå¼‚å¸¸. è¿™é‡Œçš„ <code>advice</code> å°±æ‰®æ¼”ç€é‰´æƒæ‹¦æˆªå™¨çš„è§’è‰²äº†.</em></p>
</li>
<li><p><strong>åˆ‡å…¥ç‚¹ï¼ˆPointcutï¼‰</strong></p>
<blockquote>
<p>A predicate that matches join points. Advice is associated with a pointcut expression and runs at any join point matched by the pointcut (for example, the execution of a method with a certain name). The concept of join points as matched by pointcut expressions is central to AOP, and Spring uses the AspectJ pointcut expression language by default.</p>
</blockquote>
<p>åŒ¹é…è¿æ¥ç‚¹çš„è°“è¯ã€‚é€šçŸ¥ä¸åˆ‡å…¥ç‚¹è¡¨è¾¾å¼å…³è”ï¼Œå¹¶åœ¨ä¸è¯¥åˆ‡å…¥ç‚¹åŒ¹é…çš„ä»»ä½•è¿æ¥ç‚¹å¤„è¿è¡Œï¼ˆä¾‹å¦‚ï¼Œæ‰§è¡Œå…·æœ‰ç‰¹å®šåç§°çš„æ–¹æ³•ï¼‰ã€‚ä½¿ç”¨åˆ‡å…¥ç‚¹è¡¨è¾¾å¼æ¥åŒ¹é…è¿æ¥ç‚¹æ˜¯AOPçš„æ ¸å¿ƒï¼Œå¹¶ä¸”Springé»˜è®¤ä½¿ç”¨AspectJåˆ‡å…¥ç‚¹è¡¨è¾¾è¯­è¨€ã€‚</p>
<p>åœ¨ <code>Spring</code> ä¸­, æ‰€æœ‰çš„æ–¹æ³•éƒ½å¯ä»¥è®¤ä¸ºæ˜¯ <code>joinpoint</code>, ä½†æ˜¯æˆ‘ä»¬å¹¶ä¸å¸Œæœ›åœ¨æ‰€æœ‰çš„æ–¹æ³•ä¸Šéƒ½æ·»åŠ  <code>Advice</code>, è€Œ pointcut çš„ä½œç”¨å°±æ˜¯æä¾›ä¸€ç»„è§„åˆ™(ä½¿ç”¨ <em>AspectJ pointcut expression language</em> æ¥æè¿°) æ¥åŒ¹é…<code>joinpoint</code>, ç»™æ»¡è¶³è§„åˆ™çš„ <code>joinpoint</code> æ·»åŠ  <code>Advice</code>.</p>
</li>
<li><p><strong>å¼•å…¥ï¼ˆIntroductionï¼‰</strong></p>
<blockquote>
<p>Declaring additional methods or fields on behalf of a type. Spring AOP lets you introduce new interfaces (and a corresponding implementation) to any advised object. For example, you could use an introduction to make a bean implement an <code>IsModified</code> interface, to simplify caching. (An introduction is known as an inter-type declaration in the AspectJ community.)</p>
</blockquote>
<p>ä»£è¡¨ç±»å‹å£°æ˜å…¶ä»–æ–¹æ³•æˆ–å­—æ®µã€‚ Spring AOPå…è®¸æ‚¨å‘ä»»ä½•å»ºè®®çš„å¯¹è±¡å¼•å…¥æ–°çš„æ¥å£ï¼ˆå’Œç›¸åº”çš„å®ç°ï¼‰ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<em>å¼•å…¥</em>ä½¿<code>Bean</code>å®ç°<code>IsModified</code>æ¥å£ï¼Œä»¥ç®€åŒ–ç¼“å­˜ã€‚ ï¼ˆåœ¨AspectJç¤¾åŒºä¸­ï¼Œ<strong>å¼•å…¥</strong>è¢«ç§°ä¸ºç±»å‹é—´å£°æ˜ã€‚ï¼‰</p>
</li>
</ul>
<blockquote>
<p>ä¸ºä¸€ä¸ªç±»å‹æ·»åŠ é¢å¤–çš„æ–¹æ³•æˆ–å­—æ®µ. <code>Spring AOP</code> å…è®¸æˆ‘ä»¬ä¸º <code>ç›®æ ‡å¯¹è±¡</code> å¼•å…¥æ–°çš„æ¥å£(å’Œå¯¹åº”çš„å®ç°). ä¾‹å¦‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>introduction</code> æ¥ä¸ºä¸€ä¸ª <code>bean</code> å®ç° <code>IsModified</code> æ¥å£, å¹¶ä»¥æ­¤æ¥ç®€åŒ– <code>caching</code> çš„å®ç°.</p>
</blockquote>
<ul>
<li><p><strong>ç›®æ ‡å¯¹è±¡ï¼ˆTarget objectï¼‰</strong></p>
<blockquote>
<p>An object being advised by one or more aspects. Also referred to as the â€œadvised objectâ€. Since Spring AOP is implemented by using runtime proxies, this object is always a proxied object.</p>
</blockquote>
<p>ä¸€ä¸ªæˆ–å¤šä¸ªåˆ‡é¢é€šçŸ¥çš„å¯¹è±¡ã€‚ä¹Ÿç§°ä¸ºâ€œç›®æ ‡å¯¹è±¡â€ã€‚ç”±äº<code>Spring AOP</code>æ˜¯ä½¿ç”¨è¿è¡Œæ—¶<strong>ä»£ç†</strong>å®ç°çš„ï¼Œå› æ­¤<strong>è¯¥å¯¹è±¡å§‹ç»ˆæ˜¯ä»£ç†å¯¹è±¡</strong>ã€‚</p>
<p>å› ä¸º Spring AOP ä½¿ç”¨è¿è¡Œæ—¶ä»£ç†çš„æ–¹å¼æ¥å®ç° aspect, å› æ­¤ adviced object æ€»æ˜¯ä¸€ä¸ªä»£ç†å¯¹è±¡(proxied object)ã€‚</p>
<p><em>æ³¨æ„, adviced object æŒ‡çš„ä¸æ˜¯åŸæ¥çš„ç±», è€Œæ˜¯ç»‡å…¥ advice åæ‰€äº§ç”Ÿçš„ä»£ç†ç±»</em></p>
</li>
<li><p><strong>ä»£ç†ï¼ˆAOP proxyï¼‰</strong></p>
<blockquote>
<p> An object created by the AOP framework in order to implement the aspect contracts (advise method executions and so on). In the Spring Framework, an AOP proxy is a JDK dynamic proxy or a CGLIB proxy.</p>
</blockquote>
<p>ä¸€ä¸ªç±»è¢« AOP ç»‡å…¥ <code>advice</code>ï¼Œ å°±ä¼šäº§ç”Ÿä¸€ä¸ªç»“æœç±», å®ƒæ˜¯èåˆäº†åŸç±»å’Œå¢å¼ºé€»è¾‘çš„ä»£ç†ç±»ã€‚åœ¨ Spring AOP ä¸­, ä¸€ä¸ª AOP ä»£ç†æ˜¯ä¸€ä¸ª JDK åŠ¨æ€ä»£ç†å¯¹è±¡æˆ– CGLIB ä»£ç†å¯¹è±¡ã€‚</p>
</li>
<li><p><strong>ç»‡å…¥ï¼ˆWeavingï¼‰</strong></p>
<blockquote>
<p> linking aspects with other application types or objects to create an advised object. This can be done at compile time (using the AspectJ compiler, for example), load time, or at runtime. Spring AOP, like other pure Java AOP frameworks, performs weaving at runtime.</p>
</blockquote>
<p>å°†åˆ‡é¢ä¸å…¶ä»–åº”ç”¨ç¨‹åºç±»å‹æˆ–å¯¹è±¡é“¾æ¥ä»¥åˆ›å»ºå»ºè®®çš„å¯¹è±¡ï¼ˆå°† aspect å’Œå…¶ä»–å¯¹è±¡è¿æ¥èµ·æ¥, å¹¶åˆ›å»º adviced object çš„è¿‡ç¨‹ï¼‰ã€‚è¿™å¯ä»¥åœ¨ç¼–è¯‘æ—¶ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨<code>AspectJ</code>ç¼–è¯‘å™¨ï¼‰ï¼ŒåŠ è½½æ—¶æˆ–åœ¨è¿è¡Œæ—¶å®Œæˆã€‚åƒå…¶ä»–çº¯Java AOPæ¡†æ¶ä¸€æ ·ï¼Œ<code>Spring AOP</code>åœ¨è¿è¡Œæ—¶æ‰§è¡Œç¼–ç»‡ã€‚æ ¹æ®ä¸åŒçš„å®ç°æŠ€æœ¯, AOPç»‡å…¥æœ‰ä¸‰ç§æ–¹å¼:</p>
<ul>
<li>ç¼–è¯‘å™¨ç»‡å…¥, è¿™è¦æ±‚æœ‰ç‰¹æ®Šçš„Javaç¼–è¯‘å™¨.</li>
<li>ç±»è£…è½½æœŸç»‡å…¥, è¿™éœ€è¦æœ‰ç‰¹æ®Šçš„ç±»è£…è½½å™¨.</li>
<li>åŠ¨æ€ä»£ç†ç»‡å…¥, åœ¨è¿è¡ŒæœŸä¸ºç›®æ ‡ç±»æ·»åŠ å¢å¼º(Advice)ç”Ÿæˆå­ç±»çš„æ–¹å¼.<br>Spring é‡‡ç”¨åŠ¨æ€ä»£ç†ç»‡å…¥, è€ŒAspectJé‡‡ç”¨ç¼–è¯‘å™¨ç»‡å…¥å’Œç±»è£…è½½æœŸç»‡å…¥.</li>
</ul>
</li>
</ul>
<h3 id="adviceçš„å‡ ç§ç±»å‹"><a href="#adviceçš„å‡ ç§ç±»å‹" class="headerlink" title="adviceçš„å‡ ç§ç±»å‹"></a>adviceçš„å‡ ç§ç±»å‹</h3><ul>
<li><p><strong>å‰ç½®é€šçŸ¥ï¼ˆBefore adviceï¼‰</strong></p>
<p>åœ¨è¿æ¥ç‚¹ä¹‹å‰è¿è¡Œä½†æ— æ³•é˜»æ­¢æ‰§è¡Œæµå‰è¿›åˆ°è¿æ¥ç‚¹çš„é€šçŸ¥ï¼ˆé™¤éå®ƒå¼•å‘å¼‚å¸¸ï¼‰ã€‚</p>
</li>
<li><p><strong>åç½®é€šçŸ¥ï¼ˆAfter returning adviceï¼‰</strong></p>
<p>è¿æ¥ç‚¹æ­£å¸¸å®Œæˆåè¦è¿è¡Œçš„é€šçŸ¥ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœæ–¹æ³•è¿”å›è€Œæ²¡æœ‰å¼•å‘å¼‚å¸¸ï¼‰ã€‚</p>
</li>
<li><p><strong>æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥ï¼ˆAfter throwing adviceï¼‰</strong></p>
<p>å¦‚æœå­˜åœ¨æ–¹æ³•åˆ™é€šè¿‡æŠ›å‡ºå¼‚å¸¸æ¥æ‰§è¡Œçš„é€šçŸ¥ã€‚</p>
</li>
<li><p><strong>åœ¨finallyæ‰§è¡Œåé€šçŸ¥ï¼ˆAfter (finally) adviceï¼‰</strong></p>
<p>æ— è®ºè¿æ¥ç‚¹é€€å‡ºçš„æ–¹å¼å¦‚ä½•ï¼ˆæ­£å¸¸æˆ–å¼‚å¸¸è¿”å›ï¼‰ï¼Œéƒ½å°†æ‰§è¡Œé€šçŸ¥ã€‚</p>
</li>
<li><p><strong>ç¯ç»•é€šçŸ¥ï¼ˆAround advice</strong>ï¼‰</p>
<p>å›´ç»•è”æ¥ç‚¹çš„é€šçŸ¥ï¼Œä¾‹å¦‚æ–¹æ³•è°ƒç”¨ã€‚è¿™æ˜¯æœ€æœ‰åŠ›çš„é€šçŸ¥ã€‚<strong>ç¯ç»•é€šçŸ¥å¯ä»¥åœ¨æ–¹æ³•è°ƒç”¨ä¹‹å‰å’Œä¹‹åæ‰§è¡Œè‡ªå®šä¹‰è¡Œä¸º</strong>ã€‚å®ƒè¿˜è´Ÿè´£é€‰æ‹©æ˜¯è¿”å›è¿æ¥ç‚¹è¿˜æ˜¯é€šè¿‡è¿”å›å…¶è‡ªèº«çš„è¿”å›å€¼æˆ–å¼•å‘å¼‚å¸¸æ¥è¿›è¡Œé€šçŸ¥çš„æ–¹æ³•æ‰§è¡Œã€‚</p>
</li>
</ul>
<h2 id="AOPä»£ç†"><a href="#AOPä»£ç†" class="headerlink" title="AOPä»£ç†"></a>AOPä»£ç†</h2><p><code>Spring AOP</code>é»˜è®¤å°†æ ‡å‡†<code>JDK</code>åŠ¨æ€ä»£ç†ç”¨äº<code>AOP</code>ä»£ç†ã€‚è¿™ä½¿å¾—å¯ä»¥ä»£ç†ä»»ä½•æ¥å£ï¼ˆæˆ–ä¸€ç»„æ¥å£ï¼‰ã€‚</p>
<p><code>Spring AOP</code>ä¹Ÿå¯ä»¥ä½¿ç”¨<code>CGLIB</code>ä»£ç†ã€‚è¿™å¯¹äºä»£ç†ç±»è€Œä¸æ˜¯æ¥å£æ˜¯å¿…éœ€çš„ã€‚<strong>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä¸šåŠ¡å¯¹è±¡æœªå®ç°æ¥å£ï¼Œåˆ™ä½¿ç”¨CGLIBã€‚</strong>ç”±äºå¯¹æ¥å£è€Œä¸æ˜¯å¯¹ç±»è¿›è¡Œç¼–ç¨‹æ˜¯ä¸€ç§å¥½ä¹ æƒ¯ï¼Œå› æ­¤ä¸šåŠ¡ç±»é€šå¸¸å®ç°ä¸€ä¸ªæˆ–å¤šä¸ªä¸šåŠ¡æ¥å£ã€‚åœ¨é‚£äº›éœ€è¦å»ºè®®åœ¨æ¥å£ä¸Šæœªå£°æ˜çš„æ–¹æ³•æˆ–éœ€è¦å°†ä»£ç†å¯¹è±¡ä½œä¸ºå…·ä½“ç±»å‹ä¼ é€’ç»™æ–¹æ³•çš„æƒ…å†µä¸‹ï¼ˆåœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼‰ï¼Œå¯ä»¥å¼ºåˆ¶ä½¿ç”¨<code>CGLIB</code>ã€‚</p>
<h3 id="Spring-Beançš„ç”Ÿå‘½å‘¨æœŸ"><a href="#Spring-Beançš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Spring Beançš„ç”Ÿå‘½å‘¨æœŸ"></a>Spring Beançš„ç”Ÿå‘½å‘¨æœŸ</h3><blockquote>
<p>æ’æ’­ä¸€ä¸‹Spring Beançš„ç”Ÿå‘½å‘¨æœŸ</p>
</blockquote>
<p>ä¸¤ä¸ªæ¦‚å¿µï¼š<code>Spring Bean</code> å’Œ <code>å¯¹è±¡</code>ï¼š</p>
<ol>
<li><strong>spring bean</strong>â€”â€”å—springå®¹å™¨ç®¡ç†çš„å¯¹è±¡ï¼Œå¯èƒ½ç»è¿‡äº†å®Œæ•´çš„spring beanç”Ÿå‘½å‘¨æœŸï¼ˆä¸ºä»€ä¹ˆæ˜¯å¯èƒ½ï¼Ÿéš¾é“è¿˜æœ‰beanæ˜¯æ²¡æœ‰ç»è¿‡beanç”Ÿå‘½å‘¨æœŸçš„ï¼Ÿç­”æ¡ˆæ˜¯æœ‰çš„ï¼Œå…·ä½“æˆ‘ä»¬åé¢æ–‡ç« åˆ†æï¼‰ï¼Œæœ€ç»ˆå­˜åœ¨springå®¹å™¨å½“ä¸­ï¼›ä¸€ä¸ªbeanä¸€å®šæ˜¯ä¸ªå¯¹è±¡</li>
<li><strong>å¯¹è±¡</strong>â€”â€”ä»»ä½•ç¬¦åˆjavaè¯­æ³•è§„åˆ™å®ä¾‹åŒ–å‡ºæ¥çš„å¯¹è±¡ï¼Œä½†æ˜¯ä¸€ä¸ªå¯¹è±¡å¹¶ä¸ä¸€å®šæ˜¯spring beanï¼›</li>
</ol>
<p>æ‰€è°“çš„beançš„ç”Ÿå‘½å‘¨æœŸå°±æ˜¯ç£ç›˜ä¸Šçš„ç±»é€šè¿‡Springæ‰«æï¼Œç„¶åå®ä¾‹åŒ–ï¼Œè·Ÿç€åˆå§‹åŒ–ï¼Œç»§è€Œæ”¾åˆ°å®¹å™¨å½“ä¸­çš„è¿‡ç¨‹ã€‚ä¸‹å›¾å±•ç¤ºSpring Beançš„ç”Ÿå‘½å‘¨æœŸå¤§æ¦‚æœ‰å“ªäº›æ­¥éª¤ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/cayzlh/git-img-repository@master/uPic/20191118210559319.png" alt="Spring Beançš„ç”Ÿå‘½å‘¨æœŸ"></p>
<p><strong>å…¶ä¸­AOPçš„ä»£ç†ä¹Ÿæ˜¯åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å®Œæˆçš„ã€‚</strong></p>
<h2 id="AOPçš„ä½¿ç”¨"><a href="#AOPçš„ä½¿ç”¨" class="headerlink" title="AOPçš„ä½¿ç”¨"></a>AOPçš„ä½¿ç”¨</h2><h3 id="AspectJä¸-AspectJ"><a href="#AspectJä¸-AspectJ" class="headerlink" title="AspectJä¸@AspectJ"></a>AspectJä¸@AspectJ</h3><p><code>@AspectJ</code>æ˜¯ä¸€ç§å°†åˆ‡é¢å£°æ˜ä¸ºå¸¦æœ‰æ³¨è§£çš„å¸¸è§„<code>Java</code>ç±»çš„æ ·å¼ã€‚ <code>@AspectJ</code>æ ·å¼æ˜¯<code>AspectJ</code>é¡¹ç›®åœ¨<code>AspectJ 5</code>ç‰ˆæœ¬ä¸­å¼•å…¥çš„ã€‚ <code>Spring</code>ä½¿ç”¨<code>AspectJ</code>æä¾›çš„ç”¨äºåˆ‡å…¥ç‚¹è§£æå’ŒåŒ¹é…çš„åº“æ¥è§£é‡Šä¸<code>AspectJ 5</code>ç›¸åŒçš„æ³¨è§£ã€‚ä½†æ˜¯ï¼Œ<code>AOP</code>è¿è¡Œæ—¶ä»ç„¶æ˜¯çº¯<code>Spring AOP</code>ï¼Œå¹¶ä¸”ä¸ä¾èµ–äº<code>AspectJ</code>ç¼–è¯‘å™¨æˆ–ç¼–ç»‡å™¨ã€‚</p>
<blockquote>
<p>ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œ<code>Spring</code>å€Ÿé‰´äº†<code>AspectJ</code>çš„è¯­æ³•ã€‚</p>
<p>ä½¿ç”¨<code>AspectJ</code>ç¼–è¯‘å™¨å’Œ<code>weaver</code>å¯ä»¥ä½¿ç”¨å®Œæ•´çš„<code>AspectJ</code>è¯­æ³•ã€‚</p>
</blockquote>
<blockquote>
<p>AspectJ æ˜¯æœ€æ—©ã€åŠŸèƒ½æ¯”è¾ƒå¼ºå¤§çš„ AOP å®ç°ä¹‹ä¸€ï¼Œå¯¹æ•´å¥— AOP æœºåˆ¶éƒ½æœ‰è¾ƒå¥½çš„å®ç°ï¼Œå¾ˆå¤šå…¶ä»–è¯­è¨€çš„ AOP å®ç°ï¼Œä¹Ÿå€Ÿé‰´æˆ–é‡‡çº³äº† AspectJ ä¸­å¾ˆå¤šè®¾è®¡ã€‚</p>
</blockquote>
<h3 id="å¯ç”¨-AspectJæ”¯æŒ"><a href="#å¯ç”¨-AspectJæ”¯æŒ" class="headerlink" title="å¯ç”¨@AspectJæ”¯æŒ"></a>å¯ç”¨@AspectJæ”¯æŒ</h3><ol>
<li><p>é€šè¿‡<code>Java</code>é…ç½®å¯ç”¨<code>@AspectJ</code>æ”¯æŒ</p>
<p>åœ¨é…ç½®ç±»åŠ ä¸Š<code>@EnableAspectJAutoProxy</code>æ³¨è§£ä»¥å¯ç”¨<code>@AspectJ</code>æ”¯æŒ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableAspectJAutoProxy</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>é€šè¿‡<code>XML</code>é…ç½®å¯ç”¨<code>@Aspect</code>Jæ”¯æŒ</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="å£°æ˜ä¸€ä¸ªåˆ‡é¢"><a href="#å£°æ˜ä¸€ä¸ªåˆ‡é¢" class="headerlink" title="å£°æ˜ä¸€ä¸ªåˆ‡é¢"></a>å£°æ˜ä¸€ä¸ªåˆ‡é¢</h3></li>
</ol>
<p>å¯ç”¨<code>@AspectJ</code>æ”¯æŒåï¼Œ<code>Spring</code>ä¼šè‡ªåŠ¨æ£€æµ‹åœ¨åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨<code>@AspectJ</code>åˆ‡é¢ï¼ˆå…·æœ‰<code>@Aspect</code>æ‰¹æ³¨ï¼‰çš„ç±»å®šä¹‰çš„beanï¼Œå¹¶ç”¨äºé…ç½®<code>Spring AOP</code>ã€‚</p>
<ol>
<li><p>ä½¿ç”¨xmlé…ç½®å£°æ˜åˆ‡é¢</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myAspect&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.xyz.NotVeryUsefulAspect&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- configure properties of the aspect here --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>ä½¿ç”¨æ³¨è§£å£°æ˜åˆ‡é¢</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.xyz;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NotVeryUsefulAspect</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å£°æ˜åˆ‡å…¥ç‚¹"><a href="#å£°æ˜åˆ‡å…¥ç‚¹" class="headerlink" title="å£°æ˜åˆ‡å…¥ç‚¹"></a>å£°æ˜åˆ‡å…¥ç‚¹</h3></li>
</ol>
<p>åˆ‡å…¥ç‚¹ç¡®å®šäº†å…³æ³¨çš„çš„è¿æ¥ç‚¹ï¼Œä»è€Œä½¿æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶æ‰§è¡Œé€šçŸ¥çš„æ—¶æœºã€‚ <code>Spring AOP</code>ä»…æ”¯æŒ<code>Spring Bean</code>çš„æ–¹æ³•æ‰§è¡Œè¿æ¥ç‚¹ï¼Œå¯ä»¥å°†åˆ‡å…¥ç‚¹è§†ä¸ºä¸<code>Spring Bean</code>ä¸Šçš„æ–¹æ³•æ‰§è¡ŒåŒ¹é…ã€‚</p>
<p>åˆ‡å…¥ç‚¹å£°æ˜ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šä¸€ä¸ªåŒ…å«åç§°å’Œä»»ä½•å‚æ•°çš„ç­¾åï¼Œä»¥åŠä¸€ä¸ªåˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼Œè¯¥åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ç²¾ç¡®åœ°ç¡®å®šæˆ‘ä»¬å…³æ³¨çš„æ–¹æ³•æ‰§è¡Œã€‚åœ¨<code>AOP</code>çš„<code>@AspectJ</code>æ‰¹æ³¨æ ·å¼ä¸­ï¼Œå¸¸è§„æ–¹æ³•å®šä¹‰æä¾›äº†åˆ‡å…¥ç‚¹ç­¾åã€‚ å¹¶é€šè¿‡ä½¿ç”¨<code>@Pointcut</code>æ³¨è§£å£°æ˜åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼ˆ<strong>ç”¨ä½œåˆ‡å…¥ç‚¹ç­¾åçš„æ–¹æ³•å¿…é¡»å…·æœ‰voidè¿”å›ç±»å‹</strong>ï¼‰ã€‚</p>
<p>ä¸€ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut(&quot;execution(* transfer(..))&quot;)</span> <span class="comment">// åˆ‡å…¥ç‚¹è¡¨è¾¾å¼</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">anyOldTransfer</span><span class="params">()</span> </span>&#123;&#125; <span class="comment">// åˆ‡å…¥ç‚¹æ–¹æ³•ç­¾å</span></span><br></pre></td></tr></table></figure>
<h4 id="æ”¯æŒçš„åˆ‡å…¥ç‚¹æŒ‡ç¤ºç¬¦"><a href="#æ”¯æŒçš„åˆ‡å…¥ç‚¹æŒ‡ç¤ºç¬¦" class="headerlink" title="æ”¯æŒçš„åˆ‡å…¥ç‚¹æŒ‡ç¤ºç¬¦"></a>æ”¯æŒçš„åˆ‡å…¥ç‚¹æŒ‡ç¤ºç¬¦</h4><p><code>Spring AOP</code>æ”¯æŒä»¥ä¸‹åœ¨åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ä¸­ä½¿ç”¨çš„<code>AspectJ</code>åˆ‡å…¥ç‚¹æŒ‡ç¤ºç¬¦ï¼ˆPCDï¼‰ï¼š</p>
<ul>
<li><p><code>execution</code>ï¼šåŒ¹é…æ–¹æ³•æ‰§è¡Œçš„è¿æ¥ç‚¹ï¼Œè¿™æ˜¯ä½ å°†ä¼šç”¨åˆ°çš„Springçš„æœ€ä¸»è¦çš„åˆ‡å…¥ç‚¹æŒ‡å®šè€…ã€‚</p>
<blockquote>
<p>æè¿°çš„æœ€å°ç²’åº¦ç²¾ç¡®åˆ°æ–¹æ³•ï¼ˆç”šè‡³æ–¹æ³•çš„å‚æ•°ï¼‰</p>
</blockquote>
</li>
<li><p><code>within</code>ï¼šé™å®šåŒ¹é…ç‰¹å®šç±»å‹çš„è¿æ¥ç‚¹ï¼ˆåœ¨ä½¿ç”¨SpringAOPçš„æ—¶å€™ï¼Œåœ¨åŒ¹é…çš„ç±»å‹ä¸­å®šä¹‰çš„æ–¹æ³•çš„æ‰§è¡Œï¼‰ã€‚</p>
<blockquote>
<p>æè¿°çš„æœ€å°ç²’åº¦ä»…ä»…åˆ°ä¸€ä¸ªç±»</p>
</blockquote>
</li>
<li><p><code>this</code>ï¼šé™å®šåŒ¹é…ç‰¹å®šçš„è¿æ¥ç‚¹ï¼ˆä½¿ç”¨Spring AOPçš„æ—¶å€™æ–¹æ³•çš„æ‰§è¡Œï¼‰ï¼Œå…¶ä¸­bean referenceï¼ˆSpring AOP ä»£ç†ï¼‰æ˜¯<strong>æŒ‡å®šç±»å‹çš„å®ä¾‹ã€‚</strong>ï¼ˆä»£ç†çš„å¯¹è±¡æœ¬èº«ï¼‰</p>
</li>
<li><p><code>target</code>ï¼šé™å®šåŒ¹é…ç‰¹å®šçš„è¿æ¥ç‚¹ï¼ˆä½¿ç”¨SpringAOPçš„æ—¶å€™æ–¹æ³•çš„æ‰§è¡Œï¼‰ï¼Œå…¶ä¸­ç›®æ ‡å¯¹è±¡ï¼ˆè¢«ä»£ç†çš„appolication objectï¼‰æ˜¯<strong>æŒ‡å®šç±»å‹çš„å®ä¾‹ã€‚</strong>ï¼ˆè¢«ä»£ç†çš„å¯¹è±¡ï¼‰</p>
</li>
<li><p><code>args</code>ï¼šé™å®šåŒ¹é…ç‰¹å®šçš„è¿æ¥ç‚¹ï¼ˆä½¿ç”¨Spring AOPçš„æ—¶å€™æ–¹æ³•çš„æ‰§è¡Œï¼‰ï¼Œå…¶ä¸­å‚æ•°æ˜¯æŒ‡å®šç±»å‹çš„å®ä¾‹ã€‚</p>
</li>
<li><p><code>@target</code>ï¼šé™å®šåŒ¹é…ç‰¹å®šçš„è¿æ¥ç‚¹ï¼ˆä½¿ç”¨SpringAOPçš„æ—¶å€™æ–¹æ³•çš„æ‰§è¡Œï¼‰ï¼Œå…¶ä¸­æ‰§è¡Œçš„å¯¹è±¡çš„ç±»å·²ç»æœ‰æŒ‡å®šç±»å‹çš„æ³¨è§£ã€‚</p>
</li>
<li><p>@argsï¼šé™å®šåŒ¹é…ç‰¹å®šçš„è¿æ¥ç‚¹ï¼ˆä½¿ç”¨SpringAOPçš„æ—¶å€™æ–¹æ³•çš„æ‰§è¡Œï¼‰ï¼Œå…¶ä¸­å®é™…ä¼ å…¥å‚æ•°çš„è¿è¡Œæ—¶ç±»å‹æœ‰æŒ‡å®šç±»å‹çš„æ³¨è§£ã€‚</p>
</li>
<li><p><code>@within</code>ï¼šé™å®šåŒ¹é…ç‰¹å®šçš„è¿æ¥ç‚¹ï¼Œå…¶ä¸­è¿æ¥ç‚¹æ‰€åœ¨ç±»å‹å·²æŒ‡å®šæ³¨è§£ï¼ˆåœ¨ä½¿ç”¨Spring AOPçš„æ—¶å€™ï¼Œæ‰€æ‰§è¡Œçš„æ–¹æ³•æ‰€åœ¨ç±»å‹å·²æŒ‡å®šæ³¨è§£ï¼‰ã€‚</p>
</li>
<li><p> <code>@annotation</code>ï¼šé™å®šåŒ¹é…ç‰¹å®šçš„è¿æ¥ç‚¹ï¼ˆä½¿ç”¨SpringAOPçš„æ—¶å€™æ–¹æ³•çš„æ‰§è¡Œï¼‰ï¼Œå…¶ä¸­è¿æ¥ç‚¹çš„ä¸»é¢˜æœ‰æŸç§ç»™å®šçš„æ³¨è§£åˆå¹¶åˆ‡å…¥ç‚¹è¡¨è¾¾å¼</p>
</li>
</ul>
<h4 id="ç»„åˆåˆ‡å…¥ç‚¹"><a href="#ç»„åˆåˆ‡å…¥ç‚¹" class="headerlink" title="ç»„åˆåˆ‡å…¥ç‚¹"></a>ç»„åˆåˆ‡å…¥ç‚¹</h4><p>æ‚¨å¯ä»¥ä½¿ç”¨<code>&amp;&amp;</code>ï¼Œ<code>||</code>ç»„åˆåˆ‡å…¥ç‚¹è¡¨è¾¾å¼å’Œ<code>ï¼</code>æ‚¨ä¹Ÿå¯ä»¥æŒ‰åç§°å¼•ç”¨åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€‚ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†ä¸‰ä¸ªåˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut(&quot;execution(public * *(..))&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">anyPublicOperation</span><span class="params">()</span> </span>&#123;&#125;  <span class="comment">// 1âƒ£ï¸ åŒ¹é…æ‰€æœ‰å…¬å…±æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Pointcut(&quot;within(com.xyz.someapp.trading..*)&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">inTrading</span><span class="params">()</span> </span>&#123;&#125;  <span class="comment">// 2âƒ£ï¸ åŒ¹é…æŒ‡å®šåŒ…é‡Œé¢çš„æ‰€æœ‰æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Pointcut(&quot;anyPublicOperation() &amp;&amp; inTrading()&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">tradingOperation</span><span class="params">()</span> </span>&#123;&#125;  <span class="comment">// 3âƒ£ï¸ åŒ¹é…æŒ‡å®šåŒ…é‡Œé¢çš„æ‰€æœ‰å…¬å…±æ–¹æ³•</span></span><br></pre></td></tr></table></figure>
<h4 id="å…±äº«é€šç”¨åˆ‡å…¥ç‚¹å®šä¹‰"><a href="#å…±äº«é€šç”¨åˆ‡å…¥ç‚¹å®šä¹‰" class="headerlink" title="å…±äº«é€šç”¨åˆ‡å…¥ç‚¹å®šä¹‰"></a>å…±äº«é€šç”¨åˆ‡å…¥ç‚¹å®šä¹‰</h4><p>åœ¨å¼€å‘åº”ç”¨ç¨‹åºæ—¶ï¼Œå¼€å‘äººå‘˜é€šå¸¸å¸Œæœ›ä»å¤šä¸ªæ–¹é¢å¼•ç”¨åº”ç”¨ç¨‹åºçš„æ¨¡å—å’Œç‰¹å®šçš„æ“ä½œé›†ã€‚æˆ‘ä»¬å»ºè®®ä¸ºæ­¤å®šä¹‰ä¸€ä¸ª <code>SystemArchitecture</code>åˆ‡é¢ï¼Œä»¥æ•è·å¸¸è§çš„åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€‚è¿™æ ·çš„æ–¹é¢é€šå¸¸ç±»ä¼¼äºä»¥ä¸‹ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xyz.someapp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Pointcut;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SystemArchitecture</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * A join point is in the web layer if the method is defined</span></span><br><span class="line"><span class="comment">     * in a type in the com.xyz.someapp.web package or any sub-package</span></span><br><span class="line"><span class="comment">     * under that.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Pointcut(&quot;within(com.xyz.someapp.web..*)&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">inWebLayer</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * A join point is in the service layer if the method is defined</span></span><br><span class="line"><span class="comment">     * in a type in the com.xyz.someapp.service package or any sub-package</span></span><br><span class="line"><span class="comment">     * under that.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Pointcut(&quot;within(com.xyz.someapp.service..*)&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">inServiceLayer</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * A join point is in the data access layer if the method is defined</span></span><br><span class="line"><span class="comment">     * in a type in the com.xyz.someapp.dao package or any sub-package</span></span><br><span class="line"><span class="comment">     * under that.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Pointcut(&quot;within(com.xyz.someapp.dao..*)&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">inDataAccessLayer</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * A business service is the execution of any method defined on a service</span></span><br><span class="line"><span class="comment">     * interface. This definition assumes that interfaces are placed in the</span></span><br><span class="line"><span class="comment">     * &quot;service&quot; package, and that implementation types are in sub-packages.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * If you group service interfaces by functional area (for example,</span></span><br><span class="line"><span class="comment">     * in packages com.xyz.someapp.abc.service and com.xyz.someapp.def.service) then</span></span><br><span class="line"><span class="comment">     * the pointcut expression &quot;execution(* com.xyz.someapp..service.*.*(..))&quot;</span></span><br><span class="line"><span class="comment">     * could be used instead.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Alternatively, you can write the expression using the &#x27;bean&#x27;</span></span><br><span class="line"><span class="comment">     * PCD, like so &quot;bean(*Service)&quot;. (This assumes that you have</span></span><br><span class="line"><span class="comment">     * named your Spring service beans in a consistent fashion.)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.xyz.someapp..service.*.*(..))&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">businessService</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * A data access operation is the execution of any method defined on a</span></span><br><span class="line"><span class="comment">     * dao interface. This definition assumes that interfaces are placed in the</span></span><br><span class="line"><span class="comment">     * &quot;dao&quot; package, and that implementation types are in sub-packages.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.xyz.someapp.dao.*.*(..))&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dataAccessOperation</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥åœ¨éœ€è¦åˆ‡å…¥ç‚¹è¡¨è¾¾å¼çš„ä»»ä½•åœ°æ–¹å¼•ç”¨åˆ‡é¢ä¸­å®šä¹‰çš„åˆ‡å…¥ç‚¹ã€‚ä¾‹å¦‚ï¼Œè¦ä½¿æœåŠ¡å±‚å…·æœ‰äº‹åŠ¡æ€§ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    &lt;aop:advisor</span><br><span class="line">        pointcut=&quot;com.xyz.someapp.SystemArchitecture.businessService()&quot;</span><br><span class="line">        advice-ref=&quot;tx-advice&quot;/&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;tx-advice&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;*&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h4><blockquote>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(modifiers-pattern? ret-type-pattern declaring-type-pattern?name-pattern(param-pattern) <span class="keyword">throws</span>-pattern?)</span><br></pre></td></tr></table></figure>

<ul>
<li>é—®å·è¡¨ç¤ºå½“å‰é¡¹æœ‰ä¹Ÿå¯ä»¥æ²¡æœ‰</li>
<li>å…¶ä¸­å„é¡¹è¯­ä¹‰å¦‚ä¸‹ï¼š<ul>
<li><strong>modifiers- pattern</strong>ï¼šæ–¹æ³•çš„å¯è§æ€§ï¼Œå¦‚ public, protected</li>
<li><strong>ret-type- pattern</strong>ï¼šæ–¹æ³•çš„è¿”å›å€¼ç±»å‹ï¼Œå¦‚ int, void ç­‰</li>
<li><strong>declaring-type- pattern</strong>ï¼šæ–¹æ³•æ‰€åœ¨ç±»çš„å…¨è·¯å¾„åï¼Œå¦‚ com, spring, Aspect</li>
<li><strong>name- pattern</strong>ï¼šæ–¹æ³•åï¼Œå¦‚ bui sinessservice () </li>
<li><strong>param- pattern</strong>ï¼šæ–¹æ³•çš„å‚æ•°ç±»å‹ï¼Œå¦‚ java. Lang String</li>
<li><strong>throws- pattern</strong>: æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ï¼Œå¦‚ java.Lang. Exception</li>
</ul>
</li>
</ul>
</blockquote>
<p>ä¸€äº›å¸¸è§çš„è¡¨è¾¾å¼ï¼š</p>
<ul>
<li><p>åŒ¹é…ä»»æ„<code>public</code>æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(<span class="keyword">public</span> * *(..))</span><br></pre></td></tr></table></figure></li>
<li><p>åŒ¹é…æ‰€æœ‰ä»¥<code>set</code>å¼€å¤´çš„æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(* set*(..))</span><br></pre></td></tr></table></figure></li>
<li><p>åŒ¹é…<code>AccountService</code>æ¥å£å®šä¹‰çš„ä»»ä½•æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(* com.xyz.service.AccountService.*(..))</span><br></pre></td></tr></table></figure></li>
<li><p>åŒ¹é…æŒ‡å®šåŒ…ä¸‹çš„æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(* com.xyz.service.*.*(..))</span><br></pre></td></tr></table></figure></li>
<li><p>åŒ¹é…æŒ‡å®šåŒ…ä¸‹é¢çš„ä¸€ä¸ªæˆ–å¤šä¸ªå­åŒ…ä¸‹çš„ç±»æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(* com.xyz.service..*.*(..))</span><br></pre></td></tr></table></figure></li>
<li><p>åŒ¹é…<code>service</code>åŒ…ä¸­çš„æ‰€æœ‰è¿æ¥ç‚¹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">within(com.xyz.service.*)</span><br></pre></td></tr></table></figure></li>
<li><p>åŒ¹é…<code>service</code>ä¸€ä¸ªæˆ–å¤šä¸ªå­åŒ…ä¸­çš„æ‰€æœ‰è¿æ¥ç‚¹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">within(com.xyz.service..*)</span><br></pre></td></tr></table></figure></li>
<li><p>ä»£ç†å®ç°<code>AccountService</code>æ¥å£çš„ä»»ä½•è¿æ¥ç‚¹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>(com.xyz.service.AccountService)</span><br></pre></td></tr></table></figure></li>
<li><p>ç›®æ ‡å¯¹è±¡å®ç°AccountServiceæ¥å£çš„ä»»ä½•è¿æ¥ç‚¹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">target(com.xyz.service.AccountService)</span><br></pre></td></tr></table></figure></li>
<li><p>ä»»ä½•é‡‡ç”¨å•ä¸ªå‚æ•°å¹¶ä¸”åœ¨è¿è¡Œæ—¶ä¼ é€’çš„å‚æ•°ä¸ºSerializableçš„è¿æ¥ç‚¹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">args(java.io.Serializable)</span><br></pre></td></tr></table></figure></li>
<li><p>ç›®æ ‡å¯¹è±¡å…·æœ‰<code>@Transactional</code>æ³¨è§£çš„ä»»ä½•è¿æ¥ç‚¹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@target(org.springframework.transaction.annotation.Transactional)</span></span><br></pre></td></tr></table></figure></li>
<li><p>ç›®æ ‡å¯¹è±¡çš„å£°æ˜ç±»å‹å…·æœ‰<code>@Transactional</code>æ³¨è§£çš„ä»»ä½•è¿æ¥ç‚¹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@within(org.springframework.transaction.annotation.Transactional)</span></span><br></pre></td></tr></table></figure></li>
<li><p>ä»»ä½•æ‰§è¡Œæ–¹æ³•å¸¦æœ‰@Transactionalæ‰¹æ³¨çš„è¿æ¥ç‚¹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@annotation(org.springframework.transaction.annotation.Transactional)</span></span><br></pre></td></tr></table></figure></li>
<li><p>ä»»ä½•é‡‡ç”¨å•ä¸ªå‚æ•°çš„è”æ¥ç‚¹ï¼Œå¹¶ä¸”ä¼ é€’çš„å‚æ•°çš„è¿è¡Œæ—¶ç±»å‹å…·æœ‰<code>Classified</code>æ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@args(com.xyz.security.Classified)</span></span><br></pre></td></tr></table></figure></li>
<li><p>åä¸º<code>tradeService</code>çš„<code>Spring bean</code>ä¸Šçš„ä»»ä½•è¿æ¥ç‚¹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bean(tradeService)</span><br></pre></td></tr></table></figure></li>
<li><p><code>Spring Bean</code>ä¸Šå…·æœ‰ä¸é€šé…ç¬¦è¡¨è¾¾å¼<code>* Service</code>åŒ¹é…çš„åç§°çš„ä»»ä½•è¿æ¥ç‚¹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bean(*Service)</span><br></pre></td></tr></table></figure>
<h3 id="å£°æ˜é€šçŸ¥"><a href="#å£°æ˜é€šçŸ¥" class="headerlink" title="å£°æ˜é€šçŸ¥"></a>å£°æ˜é€šçŸ¥</h3></li>
</ul>
<p>é€šçŸ¥ç”¨æ¥å£°æ˜æ–¹æ³•åœ¨åˆ‡å…¥ç‚¹è¡¨è¾¾å¼åŒ¹é…çš„æ–¹æ³•æ‰§è¡Œä¹‹å‰ï¼Œä¹‹åæˆ–å‘¨å›´è¿è¡Œã€‚åˆ‡å…¥ç‚¹è¡¨è¾¾å¼å¯ä»¥æ˜¯å¯¹å‘½ååˆ‡å…¥ç‚¹çš„ç®€å•å¼•ç”¨ï¼Œä¹Ÿå¯ä»¥æ˜¯å°±åœ°å£°æ˜çš„åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€‚</p>
<h4 id="Before-Advice"><a href="#Before-Advice" class="headerlink" title="Before Advice"></a>Before Advice</h4><p>ä½¿ç”¨<code>@Before</code>æ³¨è§£åœ¨åˆ‡é¢ä¸­å£°æ˜é€šçŸ¥ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Before;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeforeExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;com.xyz.myapp.SystemArchitecture.dataAccessOperation()&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAccessCheck</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å£°æ˜é€šçŸ¥çš„åŒæ—¶å£°æ˜åˆ‡å…¥ç‚¹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Before;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeforeExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;execution(* com.xyz.myapp.dao.*.*(..))&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAccessCheck</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="After-Returning-Advice"><a href="#After-Returning-Advice" class="headerlink" title="After Returning Advice"></a>After Returning Advice</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.AfterReturning;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AfterReturningExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterReturning(&quot;com.xyz.myapp.SystemArchitecture.dataAccessOperation()&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAccessCheck</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ‰æ—¶ï¼Œæ‚¨éœ€è¦åœ¨é€šçŸ¥æ­£æ–‡ä¸­è®¿é—®è¿”å›çš„å®é™…å€¼ã€‚æ‚¨å¯ä»¥ä½¿ç”¨<code>@AfterReturning</code>çš„å½¢å¼ç»‘å®šè¿”å›å€¼ä»¥è·å–è¯¥è®¿é—®æƒé™ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.AfterReturning;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AfterReturningExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterReturning(</span></span><br><span class="line"><span class="meta">        pointcut=&quot;com.xyz.myapp.SystemArchitecture.dataAccessOperation()&quot;,</span></span><br><span class="line"><span class="meta">        returning=&quot;retVal&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAccessCheck</span><span class="params">(Object retVal)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="After-Throwing-Advice"><a href="#After-Throwing-Advice" class="headerlink" title="After Throwing Advice"></a>After Throwing Advice</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.AfterThrowing;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AfterThrowingExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterThrowing(&quot;com.xyz.myapp.SystemArchitecture.dataAccessOperation()&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doRecoveryActions</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æŒ‡å®šå¼‚å¸¸ç±»å‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.AfterThrowing;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AfterThrowingExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterThrowing(</span></span><br><span class="line"><span class="meta">        pointcut=&quot;com.xyz.myapp.SystemArchitecture.dataAccessOperation()&quot;,</span></span><br><span class="line"><span class="meta">        throwing=&quot;ex&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doRecoveryActions</span><span class="params">(DataAccessException ex)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="After-Finally-Advice"><a href="#After-Finally-Advice" class="headerlink" title="After (Finally) Advice"></a>After (Finally) Advice</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.After;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AfterFinallyExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After(&quot;com.xyz.myapp.SystemArchitecture.dataAccessOperation()&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doReleaseLock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Around-Advice"><a href="#Around-Advice" class="headerlink" title="Around Advice"></a>Around Advice</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Around;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AroundExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;com.xyz.myapp.SystemArchitecture.businessService()&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">doBasicProfiling</span><span class="params">(ProceedingJoinPoint pjp)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        <span class="comment">// start stopwatch</span></span><br><span class="line">        Object retVal = pjp.proceed();</span><br><span class="line">        <span class="comment">// stop stopwatch</span></span><br><span class="line">        <span class="keyword">return</span> retVal;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å¼•å…¥"><a href="#å¼•å…¥" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h3><p>å¼•å…¥ï¼ˆ<strong>Introductions</strong>ï¼‰ï¼ˆåœ¨AspectJä¸­ç§°ä¸ºç±»å‹é—´å£°æ˜ï¼‰ä½¿åˆ‡é¢å¯ä»¥å£°æ˜é€šçŸ¥å¯¹è±¡å®ç°ç»™å®šçš„æ¥å£ï¼Œå¹¶ä»£è¡¨é‚£äº›å¯¹è±¡æä¾›è¯¥æ¥å£çš„å®ç°ã€‚</p>
<p>æ‚¨å¯ä»¥ä½¿ç”¨<code>@DeclareParents</code>æ‰¹æ³¨è¿›è¡Œä»‹ç»ã€‚æ­¤æ‰¹æ³¨ç”¨äºå£°æ˜åŒ¹é…ç±»å‹å…·æœ‰æ–°çš„çˆ¶ä»£ï¼ˆå› æ­¤è€Œå¾—åï¼‰ã€‚ä¾‹å¦‚ï¼Œç»™å®šä¸€ä¸ªåä¸º<code>UsageTracked</code>çš„æ¥å£å’Œè¯¥æ¥å£åä¸º<code>DefaultUsageTracked</code>çš„å®ç°ï¼Œä»¥ä¸‹æ–¹é¢å£°æ˜æœåŠ¡æ¥å£çš„æ‰€æœ‰å®ç°è€…ä¹Ÿéƒ½å®ç°äº†<code>UsageTracked</code>æ¥å£ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡JMXå…¬å¼€ç»Ÿè®¡ä¿¡æ¯ï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UsageTracking</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@DeclareParents(value=&quot;com.xzy.myapp.service.*+&quot;, defaultImpl=DefaultUsageTracked.class)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> UsageTracked mixin;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;com.xyz.myapp.SystemArchitecture.businessService() &amp;&amp; this(usageTracked)&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">recordUsage</span><span class="params">(UsageTracked usageTracked)</span> </span>&#123;</span><br><span class="line">        usageTracked.incrementUseCount();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Spring-AOPå®ä¾‹"><a href="#Spring-AOPå®ä¾‹" class="headerlink" title="Spring AOPå®ä¾‹"></a>Spring AOPå®ä¾‹</h2><p><strong>ä»£ç åœ°å€ï¼š</strong><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/cayzlh/cayzlh-demos">https://github.com/cayzlh/cayzlh-demos</a></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul>
<li><code>Spring</code>å€Ÿé‰´äº†<code>AspectJ</code>çš„è¯­æ³•</li>
<li><code>Spring</code>é€šè¿‡åŠ¨æ€ä»£ç†æ¥å®ç°<code>aop</code></li>
<li>å¯¹æ¥å£åˆ›å»ºä»£ç†ä¼˜äºå¯¹ç±»åˆ›å»ºä»£ç†ï¼Œå› ä¸ºä¼šäº§ç”Ÿæ›´åŠ æ¾è€¦åˆçš„ç³»ç»Ÿï¼Œæ‰€ä»¥springé»˜è®¤æ˜¯ä½¿ç”¨JDKä»£ç†ã€‚å¯¹ç±»ä»£ç†æ˜¯è®©é—ç•™ç³»ç»Ÿæˆ–æ— æ³•å®ç°æ¥å£çš„ç¬¬ä¸‰æ–¹ç±»åº“åŒæ ·å¯ä»¥å¾—åˆ°é€šçŸ¥ï¼Œè¿™ç§æ–¹å¼åº”è¯¥æ˜¯å¤‡ç”¨æ–¹æ¡ˆ</li>
<li>æ ‡è®°ä¸º<code>final</code>çš„æ–¹æ³•ä¸èƒ½å¤Ÿè¢«é€šçŸ¥ã€‚springæ˜¯ä¸ºç›®æ ‡ç±»äº§ç”Ÿå­ç±»ã€‚ä»»ä½•éœ€è¦è¢«é€šçŸ¥çš„æ–¹æ³•éƒ½è¢«å¤å†™ï¼Œå°†é€šçŸ¥ç»‡å…¥ã€‚<code>final</code>æ–¹æ³•æ˜¯ä¸å…è®¸é‡å†™çš„</li>
<li>springåªæ”¯æŒæ–¹æ³•è¿æ¥ç‚¹ï¼šä¸æä¾›å±æ€§æ¥å…¥ç‚¹ï¼Œspringçš„è§‚ç‚¹æ˜¯å±æ€§æ‹¦æˆªç ´åäº†å°è£…ã€‚é¢å‘å¯¹è±¡çš„æ¦‚å¿µæ˜¯å¯¹è±¡è‡ªå·±å¤„ç†å·¥ä½œï¼Œå…¶ä»–å¯¹è±¡åªèƒ½é€šè¿‡æ–¹æ³•è°ƒç”¨çš„å¾—åˆ°çš„ç»“æœ</li>
</ul>
<blockquote>
<p>springåœ¨è¿è¡ŒæœŸï¼Œç”ŸæˆåŠ¨æ€ä»£ç†å¯¹è±¡ï¼Œä¸éœ€è¦ç‰¹æ®Šçš„ç¼–è¯‘å™¨</p>
<p>Spring AOP ä¼˜å…ˆå¯¹æ¥å£è¿›è¡Œä»£ç† ï¼ˆä½¿ç”¨JdkåŠ¨æ€ä»£ç†ï¼‰å¦‚æœç›®æ ‡å¯¹è±¡æ²¡æœ‰å®ç°ä»»ä½•æ¥å£ï¼Œæ‰ä¼šå¯¹ç±»è¿›è¡Œä»£ç† ï¼ˆä½¿ç”¨cglibåŠ¨æ€ä»£ç†ï¼‰</p>
</blockquote>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#aop">Springå®˜ç½‘(aop)</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://zhuanlan.zhihu.com/p/97223347">Spring AOPç®€ä»‹ä¸åº•å±‚å®ç°æœºåˆ¶â€”â€”åŠ¨æ€ä»£ç†</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://blog.csdn.net/java_lyvee/article/details/101793774">springæºç ç³»åˆ—ï¼ˆä¸€ï¼‰â€”â€”springå¾ªç¯å¼•ç”¨</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://segmentfault.com/a/1190000007469968">å½»åº•å¾æœ Spring AOP ä¹‹ ç†è®ºç¯‡</a></li>
</ul>

  </div>

  
    <div style="text-align:center;width:100%">
      <img src="https://cdn.jsdelivr.net/gh/cayzlh/git-img-repository@master/uPic/640-2.gif">
    </div>
  

  
    <div>
      <h4>ç‰ˆæƒå£°æ˜</h4>
      <pre>
        
        <strong>æœ¬æ–‡æ¥æºï¼š </strong><a href="https://www.cayzlh.com" title="ğŸ³Antä¸¶" rel="noopener external nofollow noreferrer" target="_blank">https://www.cayzlh.com</a>

        <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="https://www.cayzlh.com/2020/03/31/741621cd.html" title="/blog/Spring%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B%EF%BC%88%E7%9F%A5%E8%AF%86%E6%A2%B3%E7%90%86%EF%BC%89">https://www.cayzlh.com/2020/03/31/741621cd.html</a>

        <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>
        
          æ–‡ç« å†…å®¹ä»…ç”¨ä½œå­¦ä¹ å’Œåˆ†äº«ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„
        
      </pre>
    </div>
  

</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/blog/">Home</a></li>
        
          <li><a href="/blog/archives/">Articles</a></li>
        
          <li><a href="/blog/about/">About</a></li>
        
          <li><a href="/blog/search/">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring-AOP%E6%A6%82%E5%BF%B5"><span class="toc-number">1.</span> <span class="toc-text">Spring AOPæ¦‚å¿µ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#advice%E7%9A%84%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.1.</span> <span class="toc-text">adviceçš„å‡ ç§ç±»å‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AOP%E4%BB%A3%E7%90%86"><span class="toc-number">2.</span> <span class="toc-text">AOPä»£ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Spring-Bean%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">2.1.</span> <span class="toc-text">Spring Beançš„ç”Ÿå‘½å‘¨æœŸ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AOP%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">3.</span> <span class="toc-text">AOPçš„ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AspectJ%E4%B8%8E-AspectJ"><span class="toc-number">3.1.</span> <span class="toc-text">AspectJä¸@AspectJ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E7%94%A8-AspectJ%E6%94%AF%E6%8C%81"><span class="toc-number">3.2.</span> <span class="toc-text">å¯ç”¨@AspectJæ”¯æŒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E%E4%B8%80%E4%B8%AA%E5%88%87%E9%9D%A2"><span class="toc-number">3.3.</span> <span class="toc-text">å£°æ˜ä¸€ä¸ªåˆ‡é¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E%E5%88%87%E5%85%A5%E7%82%B9"><span class="toc-number">3.4.</span> <span class="toc-text">å£°æ˜åˆ‡å…¥ç‚¹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%AF%E6%8C%81%E7%9A%84%E5%88%87%E5%85%A5%E7%82%B9%E6%8C%87%E7%A4%BA%E7%AC%A6"><span class="toc-number">3.4.1.</span> <span class="toc-text">æ”¯æŒçš„åˆ‡å…¥ç‚¹æŒ‡ç¤ºç¬¦</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E5%88%87%E5%85%A5%E7%82%B9"><span class="toc-number">3.4.2.</span> <span class="toc-text">ç»„åˆåˆ‡å…¥ç‚¹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B1%E4%BA%AB%E9%80%9A%E7%94%A8%E5%88%87%E5%85%A5%E7%82%B9%E5%AE%9A%E4%B9%89"><span class="toc-number">3.4.3.</span> <span class="toc-text">å…±äº«é€šç”¨åˆ‡å…¥ç‚¹å®šä¹‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Examples"><span class="toc-number">3.4.4.</span> <span class="toc-text">Examples</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E%E9%80%9A%E7%9F%A5"><span class="toc-number">3.5.</span> <span class="toc-text">å£°æ˜é€šçŸ¥</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Before-Advice"><span class="toc-number">3.5.1.</span> <span class="toc-text">Before Advice</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#After-Returning-Advice"><span class="toc-number">3.5.2.</span> <span class="toc-text">After Returning Advice</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#After-Throwing-Advice"><span class="toc-number">3.5.3.</span> <span class="toc-text">After Throwing Advice</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#After-Finally-Advice"><span class="toc-number">3.5.4.</span> <span class="toc-text">After (Finally) Advice</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Around-Advice"><span class="toc-number">3.5.5.</span> <span class="toc-text">Around Advice</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E5%85%A5"><span class="toc-number">3.6.</span> <span class="toc-text">å¼•å…¥</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring-AOP%E5%AE%9E%E4%BE%8B"><span class="toc-number">4.</span> <span class="toc-text">Spring AOPå®ä¾‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">5.</span> <span class="toc-text">æ€»ç»“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">6.</span> <span class="toc-text">å‚è€ƒ</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.facebook.com/sharer.php?u=https://www.cayzlh.com/2020/03/31/741621cd.html"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://twitter.com/share?url=https://www.cayzlh.com/2020/03/31/741621cd.html&text=Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.linkedin.com/shareArticle?url=https://www.cayzlh.com/2020/03/31/741621cd.html&title=Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://pinterest.com/pin/create/bookmarklet/?url=https://www.cayzlh.com/2020/03/31/741621cd.html&is_video=false&description=Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰&body=Check out this article: https://www.cayzlh.com/2020/03/31/741621cd.html"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://getpocket.com/save?url=https://www.cayzlh.com/2020/03/31/741621cd.html&title=Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://reddit.com/submit?url=https://www.cayzlh.com/2020/03/31/741621cd.html&title=Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.stumbleupon.com/submit?url=https://www.cayzlh.com/2020/03/31/741621cd.html&title=Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://digg.com/submit?url=https://www.cayzlh.com/2020/03/31/741621cd.html&title=Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.tumblr.com/share/link?url=https://www.cayzlh.com/2020/03/31/741621cd.html&name=Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://news.ycombinator.com/submitlink?u=https://www.cayzlh.com/2020/03/31/741621cd.html&t=Springé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆçŸ¥è¯†æ¢³ç†ï¼‰"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
<!--        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>-->
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    CAYZLH &copy;
    
    
    2019-2021
    ç²¤ICPå¤‡20058712å·-1
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        
          <li><a href="/blog/tools/">tools</a></li>
        
          <li><a href="/blog/links/">links</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/blog/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/blog/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/blog/lib/jquery/jquery.min.js"></script>


<script src="/blog/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/blog/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/blog/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-129095667-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-129095667-1');
    </script>

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->


</body>
</html>
