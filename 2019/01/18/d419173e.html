<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Java, é˜»å¡é˜Ÿåˆ—, BlockingQueue">
    <meta name="description" content="Antä¸¶çš„ç½‘ç»œæ—¥å¿—, CAYZLHç½‘ç»œæ—¥å¿—, CAYZLH, CAYZLHä¸»é¡µ, Antä¸¶ç©ºé—´">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->

    <meta name="google-site-verification" content="VrcbMTVpFGlHkIERHBt753dAtXKF4qirjnDweuXSRJw">


    <!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-129095667-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'UA-129095667-1');
</script>


    <title>Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue | BLOG | CAYZLH</title>

    
    <!-- Third-Party CSS -->
    

        <link rel="shortcut icon" href="/blog/image/favicon.ico">
        <link rel="icon" type="image/png" href="/blog/image/favicon-192x192.png" sizes="192x192">
        <link rel="apple-touch-icon" sizes="180x180" href="/blog/image/apple-touch-icon.png">

        <link rel="stylesheet" href="/blog/css/thirdparty/bootstrap.min.css">
        <link rel="stylesheet" href="/blog/css/thirdparty/octicons.css">
        <link rel="stylesheet" href="/blog/css/thirdparty/hover-min.css">
        <link rel="stylesheet" href="/blog/css/thirdparty/user-content.min.css">
        <link rel="stylesheet" href="/blog/css/thirdparty/syntax.css">
        <link rel="stylesheet" href="/blog/css/thirdparty/gitalk.css">

        <!-- My CSS -->
        <link rel="stylesheet" href="/blog/css/common.css">

        <link rel="stylesheet" href="/blog/css/sidebar-post-nav.css">

        <link rel="stylesheet" href="/blog/css/blog-page.css">
        <!-- CSS set in page -->

        
        <link rel="stylesheet" href="/blog/css/sidebar-popular-repo.css">
    

    <!-- CSS set in layout -->
    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">

    
        <script type="text/javascript" src="/blog/js/thirdparty/jquery.min.js"></script>
        <script type="text/javascript" src="/blog/js/thirdparty/bootstrap.min.js"></script>
        <script type="text/javascript" src="/blog/js/lock.js"></script>
    

    
        <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
        <script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>

        <link rel="stylesheet" href="//imsun.github.io/gitment/style/default.css">
        <script src="//imsun.github.io/gitment/dist/gitment.browser.js"></script>

        <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
        <script src="//cdn.jsdelivr.net/npm/twikoo@1.2.0/dist/twikoo.all.min.js"></script>

    

    <link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/github.min.css">
    <script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/blog/atom.xml" title="BLOG | CAYZLH" type="application/atom+xml">
</head>

<body>
<header class="site-header">
    <div class="site-header-topbar">
        <div class="container">
            <div class="topbar-menu">

    
        <div class="item">
            <a href="https://www.cayzlh.com" title="å¯¼èˆª">
                å¯¼èˆª
            </a>
        </div>
    
        <div class="item">
            <a href="/blog/categories/" title="åˆ†ç±»">
                åˆ†ç±»
            </a>
        </div>
    
        <div class="item">
            <a href="/blog/tags/" title="æ ‡ç­¾">
                æ ‡ç­¾
            </a>
        </div>
    
        <div class="item">
            <a href="/blog/links/" title="é“¾æ¥">
                é“¾æ¥
            </a>
        </div>
    
        <div class="item">
            <a href="/blog/about" title="å…³äº">
                å…³äº
            </a>
        </div>
    

</div>
        </div>
    </div>
    <div class="container">
        <a id="site-header-brand" href="/blog/" title="BLOG | CAYZLH">
            <span class="octicon octicon-mark-github"></span>
            BLOG | CAYZLH
        </a>

        <nav class="site-header-nav" role="navigation">
    
        <div class=" site-header-nav-item hvr-underline-from-center">
            <a href="/blog/" title="Home">
                Home
            </a>
            
        </div>
    
        <div class=" site-header-nav-item hvr-underline-from-center">
            <a href="/blog/archives" title="Archives">
                Archives
            </a>
            
        </div>
    
        <div class=" site-header-nav-item hvr-underline-from-center">
            <a href="/blog/" title="Learning">
                Learning
            </a>
            
                <ul class="submenu">
                    

                        <li>
                            <a href="/blog/categories/%E4%B9%A6%E7%B1%8D/%E3%80%8A%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E3%80%8B/">
                                <span>æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº</span>
                            </a>
                        </li>

                    

                        <li>
                            <a href="/blog/categories/%E4%B9%A6%E7%B1%8D/%E3%80%8AMyBatis%E6%8A%80%E6%9C%AF%E5%86%85%E5%B9%95%E3%80%8B/">
                                <span>MyBatisæŠ€æœ¯å†…å¹•</span>
                            </a>
                        </li>

                    

                        <li>
                            <a href="/blog/categories/Java/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">
                                <span>Javaè®¾è®¡æ¨¡å¼</span>
                            </a>
                        </li>

                    
                </ul>
            
        </div>
    
</nav>
    </div>
</header>
<main class="content">
    <!-- æ ‡é¢˜éƒ¨åˆ† -->
<section class="jumbotron geopattern" data-pattern-id="Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue">
    <div class="container">
        <div id="jumbotron-meta-info">
            <h1>Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue</h1>
            <span class="meta-info">
                <a><span class="octicon octicon-calendar"></span> 2019-01-18</a>
                
                    <a><span class="octicon octicon-book"></span></a>
                    
                        <a href="/blog/categories/Java/">Java</a>
                    
                
                
                    
                
            </span>
        </div>

    </div>
</section>
<script>
    $(document).ready(function(){

        $('.geopattern').each(function(){
            $(this).geopattern($(this).data('pattern-id'));
        });

    });
</script>
<!-- æ–‡ç« å†…å®¹éƒ¨åˆ† -->
<article class="post container " itemscope itemtype="http://schema.org/BlogPosting" id="openwrite-container">
    <div class="row">
        <div class="col-md-9 markdown-body">
            <!-- æ–‡ç« å¼€å§‹éƒ¨åˆ† -->
            <!--<div style="text-align:center">-->
<!--    <img style="display:inline-block" width="130" height="27"-->
<!--         src="https://cdn.jsdelivr.net/gh/cayzlh/git-img-repository@master/uPic/640-3.gif"-->
<!--         data-loaded="true">-->
<!--    <img style="display:inline-block" width="41" height="35"-->
<!--         src="https://cdn.jsdelivr.net/gh/cayzlh/git-img-repository@master/uPic/640-4.gif"-->
<!--         data-loaded="true">-->
<!--    <img style="display:inline-block"-->
<!--         width="130" height="27"-->
<!--         src="https://cdn.jsdelivr.net/gh/cayzlh/git-img-repository@master/uPic/640-5.gif"-->
<!--         data-loaded="true">-->
<!--</div>-->
            <blockquote>
<p>é˜»å¡é˜Ÿåˆ—æ˜¯ä¸€ç§é˜Ÿåˆ—ï¼Œä¸€ç§å¯ä»¥åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œå¹¶ä¸”æ”¯æŒé˜»å¡ç­‰å¾…çš„é˜Ÿåˆ—ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé˜»å¡é˜Ÿåˆ—å’Œä¸€èˆ¬çš„é˜Ÿåˆ—çš„åŒºåˆ«å°±åœ¨äºï¼š</p>
<ul>
<li>å¤šçº¿ç¨‹ç¯å¢ƒæ”¯æŒï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥å®‰å…¨çš„è®¿é—®é˜Ÿåˆ—</li>
<li>æ”¯æŒç”Ÿäº§å’Œæ¶ˆè´¹ç­‰å¾…ï¼Œå¤šä¸ªçº¿ç¨‹ä¹‹é—´äº’ç›¸é…åˆï¼Œå½“é˜Ÿåˆ—ä¸ºç©ºçš„æ—¶å€™ï¼Œæ¶ˆè´¹çº¿ç¨‹ä¼šé˜»å¡ç­‰å¾…é˜Ÿåˆ—ä¸ä¸ºç©ºï¼›å½“é˜Ÿåˆ—æ»¡äº†çš„æ—¶å€™ï¼Œç”Ÿäº§çº¿ ç¨‹å°±ä¼šé˜»å¡ç›´åˆ°é˜Ÿåˆ—ä¸æ»¡ã€‚</li>
</ul>
</blockquote>
<h2 id="é˜»å¡é˜Ÿåˆ—"><a href="#é˜»å¡é˜Ÿåˆ—" class="headerlink" title="é˜»å¡é˜Ÿåˆ—"></a>é˜»å¡é˜Ÿåˆ—</h2><p>é˜»å¡é˜Ÿåˆ—åœ¨<code>Java</code>ä¸­çš„ä¸€ç§å…¸å‹ä½¿ç”¨åœºæ™¯æ˜¯çº¿ç¨‹æ± ï¼Œåœ¨çº¿ç¨‹æ± ä¸­ï¼Œå½“æäº¤çš„ä»»åŠ¡ä¸èƒ½ç«‹å³</p>
<p>å¾—åˆ°æ‰§è¡Œçš„æ—¶å€™ï¼Œçº¿ç¨‹æ± å°±ä¼šå°†æäº¤çš„ä»»åŠ¡æ”¾åˆ°ä¸€ä¸ªé˜»å¡é˜Ÿåˆ—ä¸­æ¥ã€‚æ¯”å¦‚ä¸‹é¢çš„ä»£ç ï¼š</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> ExecutorService <span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token keyword">int</span> nThreads<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span>nThreads<span class="token punctuation">,</span> nThreads<span class="token punctuation">,</span>
                                  0L<span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">,</span>
                                  <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token operator">&lt;</span>Runnable<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>newFixedThreadPool</code>ä½¿ç”¨å¯<code>LinkedBlockingQueue</code>è¿™ç§é˜»å¡é˜Ÿåˆ—ã€‚</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> ExecutorService <span class="token function">newCachedThreadPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> Integer<span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">,</span>
                                  60L<span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>SECONDS<span class="token punctuation">,</span>
                                  <span class="token keyword">new</span> <span class="token class-name">SynchronousQueue</span><span class="token operator">&lt;</span>Runnable<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>newCachedThreadPoolä½¿ç”¨äº†SynchronousQueueè¿™ç§é˜Ÿåˆ—ï¼Œè¿™ç§é˜Ÿåˆ—çš„ç‰¹ç‚¹æ˜¯ä¸ç¼“å­˜æ•°æ®ï¼Œè€Œæ˜¯ç¼“å­˜çº¿ç¨‹ï¼Œçº¿ç¨‹åˆ†ä¸ºç”Ÿäº§è€…çº¿ç¨‹å’Œæ¶ˆè´¹è€…çº¿ç¨‹ï¼Œä¸€ä¸ªç”Ÿäº§è€…çº¿ç¨‹å’Œä¸€ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹æ˜¯äº’è¡¥çš„ï¼Œå½“ä¸€ä¸ªç”Ÿäº§è€…çº¿ç¨‹é‡åˆ°ä¸€ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹çš„æ—¶å€™å°±ä¼šç›´æ¥è¿›è¡Œæ•°æ®äº¤æ¢ï¼Œæ‰€ä»¥è¿™ç§é˜Ÿåˆ—çš„æŠ€æœ¯ç‚¹æ¯”è¾ƒé«˜ï¼Œç†è§£èµ·æ¥éš¾åº¦è¾ƒå¤§ã€‚ä¸€ä¸ªçº¿ç¨‹åªèƒ½ç¼“å­˜ä¸€ä¸ªæ•°æ®ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹æ’å…¥æ•°æ®ä¹‹åå°±ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°å¦å¤–ä¸€ä¸ªçº¿ç¨‹æ¶ˆè´¹äº†å…¶ä¸­çš„æ•°æ®ã€‚</p>
<p>é˜»å¡é˜Ÿåˆ—è¿˜æä¾›äº†å…¶ä»–ç±»å‹çš„é˜Ÿåˆ—ï¼ŒåŒ…æ‹¬åŒç«¯é˜»å¡é˜Ÿåˆ—ï¼Œå»¶æ—¶é˜»å¡é˜Ÿåˆ—ï¼Œå»¶æ—¶é˜»å¡é˜Ÿåˆ—çš„ä½¿ç”¨å¯ä»¥åœ¨newScheduledThreadPoolä¸­æ‰¾åˆ°ï¼ŒnewScheduledThreadPoolé‡Œé¢ä½¿ç”¨å»¶æ—¶é˜»å¡é˜Ÿåˆ—æ¥è°ƒåº¦å‘¨æœŸæ€§ä»»åŠ¡æ‰§è¡Œã€‚</p>
<p>ä¸‹é¢å±•ç¤ºçš„æ˜¯BlockingQueueæä¾›çš„ä¸€äº›æ–¹æ³•ï¼š</p>
<p><img src="https://github.com/cayzlh/git-img-repository/raw/master/blog/2019/01/18/2.png" alt="BlockingQueue"></p>
<h2 id="BlockingQueueçš„ä½¿ç”¨"><a href="#BlockingQueueçš„ä½¿ç”¨" class="headerlink" title="BlockingQueueçš„ä½¿ç”¨"></a>BlockingQueueçš„ä½¿ç”¨</h2><p><code>BlockingQueue</code>é€šå¸¸ç”¨äºåœ¨çº¿ç¨‹ä¸Šç”Ÿæˆå¦ä¸€ä¸ªçº¿ç¨‹æ¶ˆè€—çš„å¯¹è±¡ã€‚ä¸‹å›¾å±•ç¤ºè¿™ä¸ªè¿‡ç¨‹ï¼š</p>
<p><img src="https://github.com/cayzlh/git-img-repository/raw/master/blog/2019/01/18/1.png" alt="BlockingQueue"></p>
<p>ç”Ÿæˆçº¿ç¨‹å°†ç»§ç»­ç”Ÿæˆæ–°å¯¹è±¡å¹¶å°†å®ƒä»¬æ’å…¥é˜Ÿåˆ—ï¼Œç›´åˆ°é˜Ÿåˆ—è¾¾åˆ°å®ƒå¯ä»¥åŒ…å«çš„å†…å®¹çš„æŸä¸ªä¸Šé™ã€‚æ¢å¥è¯è¯´ï¼Œè¿™æ˜¯é™åˆ¶ã€‚å¦‚æœé˜»å¡é˜Ÿåˆ—è¾¾åˆ°å…¶ä¸Šé™ï¼Œåˆ™åœ¨å°è¯•æ’å…¥æ–°å¯¹è±¡æ—¶ä¼šé˜»æ­¢ç”Ÿæˆçº¿ç¨‹ã€‚å®ƒä¸€ç›´è¢«é˜»å¡ï¼Œç›´åˆ°æ¶ˆè´¹çº¿ç¨‹å°†ä¸€ä¸ªå¯¹è±¡ä»é˜Ÿåˆ—ä¸­å–å‡ºã€‚</p>
<p>æ¶ˆè´¹çº¿ç¨‹ä¸æ–­å°†å¯¹è±¡ä»é˜»å¡é˜Ÿåˆ—ä¸­å–å‡ºå¹¶å¤„ç†å®ƒä»¬ã€‚å¦‚æœæ¶ˆè´¹çº¿ç¨‹è¯•å›¾å°†å¯¹è±¡ä»ç©ºé˜Ÿåˆ—ä¸­å–å‡ºï¼Œåˆ™æ¶ˆè€—çº¿ç¨‹å°†è¢«é˜»å¡ï¼Œç›´åˆ°ç”Ÿæˆçº¿ç¨‹å°†å¯¹è±¡æ”¾å…¥é˜Ÿåˆ—ã€‚</p>
<h2 id="BlockingQueueçš„æ–¹æ³•"><a href="#BlockingQueueçš„æ–¹æ³•" class="headerlink" title="BlockingQueueçš„æ–¹æ³•"></a>BlockingQueueçš„æ–¹æ³•</h2><p>BlockingQueueæœ‰4ç»„ä¸åŒçš„æ–¹æ³•ç”¨äºæ’å…¥ï¼Œåˆ é™¤å’Œæ£€æŸ¥é˜Ÿåˆ—ä¸­çš„å…ƒç´ ã€‚å¦‚æœä¸èƒ½ç«‹å³æ‰§è¡Œæ‰€è¯·æ±‚çš„æ“ä½œï¼Œåˆ™æ¯ç»„æ–¹æ³•çš„è¡Œä¸ºéƒ½ä¸åŒã€‚</p>
<table>
<thead>
<tr>
<th>æ“ä½œç±»å‹</th>
<th>Throws Exception</th>
<th>Special Value</th>
<th>Blocks</th>
<th>Times Out</th>
</tr>
</thead>
<tbody><tr>
<td>æ’å…¥</td>
<td>add(o)</td>
<td>offer(o)</td>
<td>put(o)</td>
<td>offer(o, timeout, timeunit)</td>
</tr>
<tr>
<td>å–å‡ºï¼ˆåˆ é™¤ï¼‰</td>
<td>remove(o)</td>
<td>poll()</td>
<td>take()</td>
<td>poll(timeout, timeunit)</td>
</tr>
<tr>
<td>æ£€æŸ¥</td>
<td>element()</td>
<td>peek()</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>å››ç§æ“ä½œçš„å«ä¹‰ï¼š</p>
<ul>
<li><code>Throws Exception</code>ï¼š å¦‚æœæ— æ³•ç«‹å³å°è¯•æ“ä½œï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚ </li>
<li><code>Special Value</code>ï¼š å¦‚æœæ— æ³•ç«‹å³å°è¯•æ“ä½œï¼Œåˆ™è¿”å›ç‰¹æ®Šå€¼ï¼ˆé€šå¸¸ä¸ºtrue / falseï¼‰ã€‚ </li>
<li><code>Blocks</code>ï¼š å¦‚æœæ— æ³•ç«‹å³æ‰§è¡Œå°è¯•çš„æ“ä½œï¼Œåˆ™æ–¹æ³•è°ƒç”¨å°†é˜»å¡ç›´åˆ°å®ƒä¸ºæ­¢ã€‚ </li>
<li><code>Times Out</code>ï¼š å¦‚æœæ— æ³•ç«‹å³æ‰§è¡Œå°è¯•çš„æ“ä½œï¼Œåˆ™æ–¹æ³•è°ƒç”¨å°†é˜»å¡ç›´åˆ°å®ƒï¼Œä½†ç­‰å¾…ä¸è¶…è¿‡ç»™å®šçš„è¶…æ—¶ã€‚è¿”å›ä¸€ä¸ªç‰¹æ®Šå€¼ï¼Œå‘ŠçŸ¥æ“ä½œæ˜¯å¦æˆåŠŸï¼ˆé€šå¸¸ä¸ºtrue / falseï¼‰ã€‚</li>
</ul>
<blockquote>
<p>æ— æ³•åœ¨<code>BlockingQueue</code>ä¸­æ’å…¥<code>null</code>ã€‚å¦‚æœæ‚¨å°è¯•æ’å…¥<code>null</code>ï¼Œåˆ™<code>BlockingQueue</code>å°†æŠ›å‡º<code>NullPointerException</code>ã€‚</p>
</blockquote>
<p>å¯ä»¥è®¿é—®<code>BlockingQueue</code>ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œè€Œä¸ä»…ä»…æ˜¯å¼€å¤´å’Œç»“å°¾çš„å…ƒç´ ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨å·²æ’é˜Ÿå¯¹è±¡è¿›è¡Œå¤„ç†ï¼Œä½†æ‚¨çš„åº”ç”¨ç¨‹åºå†³å®šå–æ¶ˆå®ƒã€‚ç„¶åå¯ä»¥è°ƒç”¨<code>remove(o)</code>åˆ é™¤é˜Ÿåˆ—ä¸­çš„ç‰¹å®šå¯¹è±¡ã€‚ä½†æ˜¯ï¼Œè¿™ä¸æ˜¯éå¸¸æœ‰æ•ˆï¼Œæ‰€ä»¥é™¤éä½ çœŸçš„éœ€è¦ï¼Œå¦åˆ™ä½ ä¸åº”è¯¥ä½¿ç”¨è¿™äº›<code>Collection</code>æ–¹æ³•ã€‚</p>
<h2 id="BlockingQueueå®ç°ç±»"><a href="#BlockingQueueå®ç°ç±»" class="headerlink" title="BlockingQueueå®ç°ç±»"></a>BlockingQueueå®ç°ç±»</h2><p><code>BlockingQueue</code>æ˜¯ä¸€ä¸ªæ¥å£ï¼Œéœ€è¦é€šè¿‡å®ƒçš„å®ç°ç±»æ¥ä½¿ç”¨å®ƒï¼Œ<code>BlockingQueue</code>æœ‰ä»¥ä¸‹å®ç°ç±»ï¼š</p>
<p><img src="https://github.com/cayzlh/git-img-repository/raw/master/blog/2019/01/18/3.png" alt="BlockingQueue Implementations"></p>
<h3 id="ArrayBlockingQueue"><a href="#ArrayBlockingQueue" class="headerlink" title="ArrayBlockingQueue"></a>ArrayBlockingQueue</h3><p><code>ArrayBlockingQueue</code>æ˜¯ä¸€ä¸ªæœ‰ç•Œçš„é˜»å¡é˜Ÿåˆ—ï¼Œå®ƒå°†å…ƒç´ å­˜å‚¨åœ¨æ•°ç»„å†…éƒ¨ã€‚å®ƒæœ‰ç•Œæ„å‘³ç€å®ƒæ— æ³•å­˜å‚¨æ— é™é‡çš„å…ƒç´ ã€‚å®ƒå¯ä»¥åŒæ—¶å­˜å‚¨çš„å…ƒç´ æ•°é‡æœ‰ä¸€ä¸ªä¸Šé™ã€‚åœ¨å®ä¾‹åŒ–æ—¶è®¾ç½®ä¸Šé™ï¼Œä¹‹åæ— æ³•æ›´æ”¹ã€‚</p>
<p><code>ArrayBlockingQueue</code>ä»¥<code>FIFO</code>ï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰é¡ºåºåœ¨å†…éƒ¨å­˜å‚¨å…ƒç´ ã€‚é˜Ÿåˆ—çš„å¤´éƒ¨æ˜¯é˜Ÿåˆ—ä¸­æœ€é•¿æ—¶é—´çš„å…ƒç´ ï¼Œé˜Ÿåˆ—çš„å°¾éƒ¨æ˜¯é˜Ÿåˆ—ä¸­æœ€çŸ­æ—¶é—´çš„å…ƒç´ ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å¦‚ä½•å®ä¾‹åŒ–å’Œä½¿ç”¨<code>ArrayBlockingQueue</code>ï¼š</p>
<pre class="line-numbers language-java"><code class="language-java">BlockingQueue queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayBlockingQueue</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

queue<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Object object <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="DelayQueue"><a href="#DelayQueue" class="headerlink" title="DelayQueue"></a>DelayQueue</h3><p><code>DelayQueue</code>åœ¨å†…éƒ¨é˜»æ­¢å…ƒç´ ï¼Œç›´åˆ°æŸä¸ªå»¶è¿Ÿåˆ°æœŸã€‚å…ƒç´ å¿…é¡»å®ç°<code>java.util.concurrent.Delayed</code>æ¥å£ã€‚ä»¥ä¸‹æ˜¯è¯¥æ¥å£çš„å®šä¹‰ï¼š</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Delayed</span> <span class="token keyword">extends</span> <span class="token class-name">Comparable</span><span class="token operator">&lt;</span>Delayed<span class="token operator">&lt;</span> <span class="token punctuation">{</span>

 <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getDelay</span><span class="token punctuation">(</span>TimeUnit timeUnit<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œå°±æ˜¯è¦è·å–æ¶ˆè´¹å»¶æ—¶ã€‚</p>
<p>å»¶æ—¶é˜»å¡é˜Ÿåˆ—ä½¿ç”¨äº†ä¼˜å…ˆé˜»å¡é˜Ÿåˆ—æ¥å­˜å‚¨æ•°æ®ï¼Œæ•°æ®çš„è·å–æ˜¯æœ‰ä¼˜å…ˆçº§çš„ï¼Œè¿™ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œåœ¨è¿™ç‚¹ä¸Šï¼Œæˆ‘ä»¬åº”è¯¥å’Œjavaçš„çº¿ç¨‹æ± çš„è°ƒåº¦çº¿ç¨‹æ± çš„å®ç°è”ç³»èµ·æ¥ï¼Œåœ¨javaçš„è°ƒåº¦çº¿ç¨‹æ± çš„å®ç°ä¸Šï¼Œä¹Ÿä½¿ç”¨äº†å»¶æ—¶é˜Ÿåˆ—ï¼Œè€Œä¼˜å…ˆçº§é˜Ÿåˆ—å¯ä»¥ä¿è¯çº¿ç¨‹æ± è°ƒåº¦çš„ä»»åŠ¡éƒ½æ˜¯æ ¹æ®æ—¶é—´ä¼˜å…ˆçº§è¢«è°ƒåº¦çš„ã€‚takeæ–¹æ³•é¦–å…ˆä»ä¼˜å…ˆé˜Ÿåˆ—ä¸­è·å–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œç„¶åè¯¢é—®æ˜¯å¦éœ€è¦å»¶æ—¶ï¼Œå¦‚æœä¸éœ€è¦ï¼Œåˆ™ç›´æ¥è¿”å›ï¼Œå¦åˆ™å»¶æ—¶è®¾å®šçš„æ—¶é—´ä¹‹åå†è¿”å›ã€‚</p>
<p>Exampleï¼š</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DelayQueueExample</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        DelayQueue queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DelayQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        Delayed element1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DelayedElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        queue<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>element1<span class="token punctuation">)</span><span class="token punctuation">;</span>

        Delayed element2 <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="LinkedBlockingQueue"><a href="#LinkedBlockingQueue" class="headerlink" title="LinkedBlockingQueue"></a>LinkedBlockingQueue</h3><p><code>LinkedBlockingQueue</code>ä½¿ç”¨é“¾è¡¨æ¥ä½œä¸ºé˜Ÿåˆ—çš„æ•°æ®ç»“æ„ï¼Œä¸‹é¢å°±æ˜¯é“¾è¡¨èŠ‚ç‚¹çš„æ•°æ®ç»“æ„ï¼š</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token operator">&lt;</span>E<span class="token operator">></span> <span class="token punctuation">{</span>
        E item<span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * One of:
     * - the real successor Node
     * - this Node, meaning the successor is head.next
     * - null, meaning there is no successor (this is the last node)
     */</span>
    Node<span class="token operator">&lt;</span>E<span class="token operator">></span> next<span class="token punctuation">;</span>

    <span class="token function">Node</span><span class="token punctuation">(</span>E x<span class="token punctuation">)</span> <span class="token punctuation">{</span> item <span class="token operator">=</span> x<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>LinkedBlockingQueue</code>å°†å…ƒç´ ä¿ç•™åœ¨é“¾æ¥ç»“æ„ï¼ˆé“¾æ¥èŠ‚ç‚¹ï¼‰å†…éƒ¨ã€‚å¦‚æœéœ€è¦ï¼Œè¯¥è¿æ¥ç»“æ„å¯ä»»é€‰åœ°å…·æœ‰ä¸Šé™ã€‚å¦‚æœæœªæŒ‡å®šä¸Šé™ï¼Œåˆ™ä½¿ç”¨<code>Integer.MAX_VALUE</code>ä½œä¸ºä¸Šé™ã€‚</p>
<p><code>LinkedBlockingQueue</code>åœ¨å†…éƒ¨ä»¥<code>FIFO</code>ï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰é¡ºåºå­˜å‚¨å…ƒç´ ã€‚é˜Ÿåˆ—çš„å¤´éƒ¨æ˜¯é˜Ÿåˆ—ä¸­æœ€é•¿æ—¶é—´çš„å…ƒç´ ï¼Œé˜Ÿåˆ—çš„å°¾éƒ¨æ˜¯é˜Ÿåˆ—ä¸­æœ€çŸ­æ—¶é—´çš„å…ƒç´ ã€‚</p>
<p>Exampleï¼š</p>
<pre class="line-numbers language-java"><code class="language-java">BlockingQueue<span class="token operator">&lt;</span>String<span class="token operator">></span> unbounded <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token operator">&lt;</span>String<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
BlockingQueue<span class="token operator">&lt;</span>String<span class="token operator">></span> bounded   <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token operator">&lt;</span>String<span class="token operator">></span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

bounded<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"Value"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

String value <span class="token operator">=</span> bounded<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="PriorityBlockingQueue"><a href="#PriorityBlockingQueue" class="headerlink" title="PriorityBlockingQueue"></a>PriorityBlockingQueue</h3><p><code>PriorityBlockingQueue</code>æ˜¯ä¸€ä¸ªæ— é™åˆ¶çš„å¹¶å‘é˜Ÿåˆ—ã€‚ å®ƒä½¿ç”¨ä¸<code>java.util.PriorityQueue</code>ç±»ç›¸åŒçš„æ’åºè§„åˆ™ã€‚ ä¸èƒ½å°†<code>null</code>æ’å…¥æ­¤é˜Ÿåˆ—ã€‚</p>
<p>æ’å…¥<code>PriorityBlockingQueue</code>çš„æ‰€æœ‰å…ƒç´ éƒ½å¿…é¡»å®ç°<code>java.lang.Comparable</code>æ¥å£ã€‚ å› æ­¤ï¼Œå…ƒç´ æ ¹æ®æ‚¨åœ¨<code>Comparable</code>å®ç°ä¸­å†³å®šçš„ä¼˜å…ˆçº§è¿›è¡Œæ’åºã€‚</p>
<blockquote>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<code>PriorityBlockingQueue</code>ä¸ä¼šå¯¹å…·æœ‰ç›¸åŒä¼˜å…ˆçº§çš„å…ƒç´ å¼ºåˆ¶æ‰§è¡Œä»»ä½•ç‰¹å®šè¡Œä¸ºï¼ˆ<code>compareï¼ˆï¼‰== 0</code>ï¼‰ã€‚</p>
<p>å¦‚æœä»<code>PriorityBlockingQueue</code>è·å–<code>Iterator</code>ï¼Œ<code>Iterator</code>ä¸ä¿è¯æŒ‰ä¼˜å…ˆçº§é¡ºåºè¿­ä»£å…ƒç´ ã€‚</p>
</blockquote>
<p>Exampleï¼š</p>
<pre class="line-numbers language-java"><code class="language-java">BlockingQueue queue   <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PriorityBlockingQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//String implements java.lang.Comparable</span>
queue<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"Value"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

String value <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="SynchronousQueue"><a href="#SynchronousQueue" class="headerlink" title="SynchronousQueue"></a>SynchronousQueue</h3><p><code>SynchronousQueue</code>æ˜¯ä¸€ä¸ªå†…éƒ¨åªèƒ½åŒ…å«å•ä¸ªå…ƒç´ çš„é˜Ÿåˆ—ã€‚ å°†å…ƒç´ æ’å…¥é˜Ÿåˆ—çš„çº¿ç¨‹è¢«é˜»å¡ï¼Œç›´åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ä»é˜Ÿåˆ—ä¸­è·å–è¯¥å…ƒç´ ã€‚ åŒæ ·ï¼Œå¦‚æœçº¿ç¨‹å°è¯•è·å–å…ƒç´ å¹¶ä¸”å½“å‰ä¸å­˜åœ¨ä»»ä½•å…ƒç´ ï¼Œåˆ™è¯¥çº¿ç¨‹å°†è¢«é˜»å¡ï¼Œç›´åˆ°çº¿ç¨‹å°†å…ƒç´ æ’å…¥é˜Ÿåˆ—ã€‚æ˜¯æœ€ä¸ºå¤æ‚çš„é˜»å¡é˜Ÿåˆ—ã€‚</p>
<p>ä»»ä½•æ’å…¥æ“ä½œéƒ½éœ€è¦ç­‰å¾…å…¶ä»–çº¿ç¨‹æ¥æ¶ˆè´¹ï¼Œå¦åˆ™å°±ä¼šé˜»å¡ç­‰å¾…ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç”Ÿäº§çº¿ç¨‹ç”Ÿäº§å‡ºä¸€æ¡æ•°æ®ä¹‹åå°±è¦ç­‰å¾…æ¶ˆè´¹è€…çº¿ç¨‹æ¥å°†å…¶æ¶ˆè´¹æ‰ï¼Œæ‰èƒ½ç»§ç»­ç”Ÿäº§æ•°æ®ï¼Œå¦åˆ™å°±ä¼šé˜»å¡ç­‰å¾…æ¶ˆè´¹ã€‚é˜Ÿåˆ—ä¸­ä¼šæŠŠåˆ°æ¥çš„çº¿ç¨‹ç¼“å­˜èµ·æ¥ï¼Œå½“ç„¶ä¼šè¿›è¡Œä¸€äº›æ“ä½œï¼Œä¸‹é¢æ˜¯å¤§æ¦‚çš„ç®—æ³•ï¼š</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token number">1</span>ã€é˜Ÿåˆ—åˆå§‹åŒ–ä¸ºnull
<span class="token number">2</span>ã€å½“ä¸€ä¸ªçº¿ç¨‹è¾¾åˆ°ä¹‹åï¼Œå¦‚æœé˜Ÿåˆ—ä¸ºnullï¼Œåˆ™å°†è¯¥çº¿ç¨‹æ”¾åˆ°é˜Ÿåˆ—ä¸­å»ï¼Œå¦åˆ™ï¼Œåˆ¤æ–­é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯å¦å’Œå½“å‰åˆ°è¾¾çš„å…ƒç´ 
åŒ¹é…ï¼Œå¦‚æœåŒ¹é…ï¼Œé‚£ä¹ˆä¸¤ä¸ªçº¿ç¨‹çš„æ•°æ®äº¤æ˜“å®Œæˆï¼Œå¦åˆ™ä¹Ÿå°†æ–°åˆ°è¾¾çš„çº¿ç¨‹æ•°æ®ç¼“å­˜åˆ°é˜Ÿåˆ—ä¸­ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><code>SynchronousQueue</code>é€šè¿‡ä½¿ç”¨<code>Transferer</code>ç±»çš„<code>transfer(E e, boolean timed, long nanos)</code>æ–¹æ³•æ¥å®Œæˆæ•°æ®äº¤æ˜“æ“ä½œï¼Œæ ¹æ®<code>fair</code>æ¨¡å¼å’Œ<code>non-fair</code>æ¨¡å¼æœ‰ä¸¤ç§ç±»å‹çš„<code>Transferer</code>ï¼Œ<code>fair</code>æ¨¡å¼å¯¹åº”äº<code>TransferQueue</code>ï¼Œ<code>non-fair</code>æ¨¡å¼å¯¹åº”<code>TransferStack</code>ã€‚</p>
<h2 id="Java-BlockingQueue-Example"><a href="#Java-BlockingQueue-Example" class="headerlink" title="Java BlockingQueue Example"></a>Java BlockingQueue Example</h2><p>è¿™æ˜¯ä¸€ä¸ª<code>Java BlockingQueue</code>ç¤ºä¾‹ã€‚è¯¥ç¤ºä¾‹ä½¿ç”¨<code>BlockingQueue</code>æ¥å£çš„<code>ArrayBlockingQueue</code>å®ç°ã€‚</p>
<p>å®ç°çš„æµç¨‹å¦‚ä¸‹ï¼Œ<code>BlockingQueueExample</code>ç±»åœ¨å•ç‹¬çš„çº¿ç¨‹ä¸­å¯åŠ¨<code>Producer</code>å’Œ<code>Consumer</code>ã€‚ <code>Producer</code>å°†å­—ç¬¦ä¸²æ’å…¥å…±äº«çš„<code>BlockingQueue</code>ï¼Œç„¶å<code>Consumer</code>å°†å®ƒä»¬å–å‡ºã€‚</p>
<h3 id="Producer"><a href="#Producer" class="headerlink" title="Producer"></a>Producer</h3><p>ç¼–å†™ç”Ÿäº§è€…ä»£ç ï¼š</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Producer</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

    <span class="token keyword">protected</span> BlockingQueue queue <span class="token operator">=</span> null<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">Producer</span><span class="token punctuation">(</span>BlockingQueue queue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>queue <span class="token operator">=</span> queue<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            queue<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            queue<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            queue<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="Consumer"><a href="#Consumer" class="headerlink" title="Consumer"></a>Consumer</h3><p>æ¶ˆè´¹è€…ä»£ç ï¼š</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Consumer</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

    <span class="token keyword">protected</span> BlockingQueue queue <span class="token operator">=</span> null<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">Consumer</span><span class="token punctuation">(</span>BlockingQueue queue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>queue <span class="token operator">=</span> queue<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>queue<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>queue<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>queue<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>ç¤ºä¾‹ä»£ç (<code>main()</code>)ï¼š</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArrayBlockingQueueExample</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException <span class="token punctuation">{</span>
        ArrayBlockingQueue queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayBlockingQueue</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Producer producer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Producer</span><span class="token punctuation">(</span>queue<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Consumer consumer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Consumer</span><span class="token punctuation">(</span>queue<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>producer<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>consumer<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<pre class="line-numbers language-shell"><code class="language-shell">1
2
3

Process finished with exit code 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

            <!-- æ–‡ç« ç»“å°¾éƒ¨åˆ† -->
            
                
<div style="text-align:center;width:100%">
    <span class="octicon octicon-tag-add"></span>
    
        <a style="color: #24292e;" href="/blog/tags/Java/">Java</a>
    
        <a style="color: #24292e;" href="/blog/tags/concurrent/">concurrent</a>
    
</div>



    <div style="text-align:center;width:100%">
        <img src="https://cdn.jsdelivr.net/gh/cayzlh/git-img-repository@master/uPic/640-2.gif">
    </div>




<div>
    <h4>ç›¸å…³æ¨è</h4>
    <ul class="post-copyright">
        
        <li class="post-copyright-author">
            <a href="/blog/2020/09/29/138fc827.html">APIç­¾åéªŒè¯æ–¹æ¡ˆ</a>
        </li>
        
        <li class="post-copyright-author">
            <a href="/blog/2019/09/18/9fc188b6.html">Gsonç®€æ˜“æŒ‡å—</a>
        </li>
        
        <li class="post-copyright-author">
            <a href="/blog/2018/08/19/95c0309a.html">JVM (å†…å­˜åŒºåŸŸæ§åˆ¶å‚æ•°åŠå¯¹åº”æº¢å‡ºå¼‚å¸¸)</a>
        </li>
        
        <li class="post-copyright-author">
            <a href="/blog/2019/01/22/1abc3648.html">JDK8ç‰¹æ€§ä¸€è§ˆ</a>
        </li>
        
        <li class="post-copyright-author">
            <a href="/blog/2018/08/19/99ebe472.html">JVM (åƒåœ¾æ”¶é›†)</a>
        </li>
        
        <li class="post-copyright-author">
            <a href="/blog/2018/08/19/e43d0ef1.html">JVM (å¯¹è±¡è®¿é—®å†…éƒ¨å®ç°è¿‡ç¨‹)</a>
        </li>
        
    </ul>
    <br><br>
</div>



<div>
    <h4>ç‰ˆæƒå£°æ˜</h4>
    <blockquote>
        <ul class="post-copyright">
            <li class="post-copyright-author">
                <strong>æœ¬æ–‡æ¥æºï¼š </strong>
                
                <a href="https://www.cayzlh.com/blog" title="ğŸ³Antä¸¶" rel="noopener external nofollow noreferrer" target="_blank">ğŸ³Antä¸¶</a></li>
            <li class="post-copyright-link">
                <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
                <a href="https://www.cayzlh.com/2019/01/18/d419173e.html" title="/blog/Java%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97%E4%B9%8BBlockingQueue">https://www.cayzlh.com/2019/01/18/d419173e.html</a>
            </li>
            <li class="post-copyright-license">
                <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>
                
                    æ–‡ç« å†…å®¹ä»…ç”¨ä½œå­¦ä¹ å’Œåˆ†äº«ï¼Œå¦‚æœ‰é›·åŒï¼Œçº¯å±æ‹·è´ã€‚
                
            </li>
        </ul>
    </blockquote>
</div>


            
            
                <div class="comment">
    <br><br><br>
    
        

        

        

        
                <h4>ç•™è¨€åŒº</h4>
                <div id="tcomment"></div>
                <script src="https://cdn.jsdelivr.net/npm/twikoo@1.2.0/dist/twikoo.all.min.js"></script>
                <script>
                twikoo.init({
                        envId: 'cayzlh-7g0jcpd31a34ccaf',
                        el: '#tcomment',
                        region: 'ap-guangzhou', // ç¯å¢ƒåœ°åŸŸï¼Œé»˜è®¤ä¸º ap-shanghaiï¼Œå¦‚æœæ‚¨çš„ç¯å¢ƒåœ°åŸŸä¸æ˜¯ä¸Šæµ·ï¼Œéœ€ä¼ æ­¤å‚æ•°
                        // path: 'window.location.pathname', // ç”¨äºåŒºåˆ†ä¸åŒæ–‡ç« çš„è‡ªå®šä¹‰ js è·¯å¾„ï¼Œå¦‚æœæ‚¨çš„æ–‡ç« è·¯å¾„ä¸æ˜¯ location.pathnameï¼Œéœ€ä¼ æ­¤å‚æ•°
                })
                </script>
        

    
</div>

            
        </div>
        <div class="col-md-3 markdown-body">
            <h4>æ–‡ç« ç›®å½•</h4>
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#é˜»å¡é˜Ÿåˆ—"><span class="toc-text">é˜»å¡é˜Ÿåˆ—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BlockingQueueçš„ä½¿ç”¨"><span class="toc-text">BlockingQueueçš„ä½¿ç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BlockingQueueçš„æ–¹æ³•"><span class="toc-text">BlockingQueueçš„æ–¹æ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BlockingQueueå®ç°ç±»"><span class="toc-text">BlockingQueueå®ç°ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ArrayBlockingQueue"><span class="toc-text">ArrayBlockingQueue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DelayQueue"><span class="toc-text">DelayQueue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LinkedBlockingQueue"><span class="toc-text">LinkedBlockingQueue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PriorityBlockingQueue"><span class="toc-text">PriorityBlockingQueue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SynchronousQueue"><span class="toc-text">SynchronousQueue</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Java-BlockingQueue-Example"><span class="toc-text">Java BlockingQueue Example</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Producer"><span class="toc-text">Producer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Consumer"><span class="toc-text">Consumer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Example"><span class="toc-text">Example</span></a></li></ol></li></ol>
        </div>
    </div>
    
</article>


<script>
    hljs.initHighlightingOnLoad();
</script>
</main>
<footer class="container">
    <div class="site-footer">
        
    <div class="card text-center">
        <ul class="list-inline" style="margin-left: 0;">
            
                <li>
                    <a target="_blank" href="https://github.com/cayzlh" rel="external nofollow noopener noreferrer">
                          <span class="fa-stack fa-lg">
                            <i class="fa fa-circle fa-stack-2x"></i>
                            <i class="fa fa-github fa-stack-1x fa-inverse">
                                
                            </i>
                          </span>
                    </a>
                </li>
            
                <li>
                    <a target="_blank" href="mailto:chenanyu@cayzlh.com">
                          <span class="fa-stack fa-lg">
                            <i class="fa fa-circle fa-stack-2x"></i>
                            <i class="fa fa-envelope fa-stack-1x fa-inverse">
                                
                            </i>
                          </span>
                    </a>
                </li>
            
        </ul>
    </div>


        <div class="site-footer-links mobile-hidden">
            
                
                
            
        </div>

        <div class="site-footer-links mobile-hidden">
        
            <span class="meta-info-index hvr-grow">
                
                    <a href="https://www.cayzlh.com">
                        ğŸ³Antä¸¶ &copy; 2020
                    </a>
                
            </span>
        
        
            <span class="meta-info-index hvr-grow">
                <a href="http://beian.miit.gov.cn" target="_blank" rel="external nofollow noopener noreferrer">ç²¤ICPå¤‡20058712å·-1</a>
            </span>
        
        </div>

        

        
    </div>
    

    
        <!-- Third-Party JS -->
        <script type="text/javascript" src="/blog/js/thirdparty/geopattern.min.js"></script>
        <!-- My JS -->
        <script type="text/javascript" src="/blog/js/script.js"></script>
    

    
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
        </script>
    
</footer>
</body>
</html>