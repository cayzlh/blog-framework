<!DOCTYPE html>
<html lang="en">
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="java.util.concurrentåŒ…ä¸­çš„Java BlockingQueueæ¥å£æ˜¯ä¸€ä¸ªå¯ä»¥æ”¾å…¥çº¿ç¨‹å¹¶ä»ä¸­è·å–å®ä¾‹çš„é˜Ÿåˆ—ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue">
<meta property="og:url" content="https://www.cayzlh.com/blog">
<meta property="og:site_name" content="CAYZLH">
<meta property="og:description" content="java.util.concurrentåŒ…ä¸­çš„Java BlockingQueueæ¥å£æ˜¯ä¸€ä¸ªå¯ä»¥æ”¾å…¥çº¿ç¨‹å¹¶ä»ä¸­è·å–å®ä¾‹çš„é˜Ÿåˆ—ã€‚">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://github.com/cayzlh/git-img-repository/raw/master/blog/2019/01/18/2.png">
<meta property="og:image" content="https://github.com/cayzlh/git-img-repository/raw/master/blog/2019/01/18/1.png">
<meta property="og:image" content="https://github.com/cayzlh/git-img-repository/raw/master/blog/2019/01/18/3.png">
<meta property="article:published_time" content="2019-01-18T09:24:44.000Z">
<meta property="article:modified_time" content="2020-06-22T01:29:06.037Z">
<meta property="article:author" content="ğŸ³Antä¸¶">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="concurrent">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/cayzlh/git-img-repository/raw/master/blog/2019/01/18/2.png">
    
    
      
        
          <link rel="shortcut icon" href="/blog/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/blog/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/blog/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/blog/css/rtl.css">

    
    <!-- rss -->
    
    
      <link rel="alternate" href="/blog/true" title="CAYZLH" type="application/atom+xml">
    
<meta name="generator" content="Hexo 5.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        
          <li><a href="/blog/">Home</a></li>
        
          <li><a href="/blog/archives/">Articles</a></li>
        
          <li><a href="/blog/about/">About</a></li>
        
          <li><a href="/blog/search/">Search</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/blog/2019/01/22/1abc3648.html"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/blog/2019/01/17/36752c3e.html"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
<!--        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>-->
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous</span>
      <span id="i-next" class="info" style="display:none;">Next</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.facebook.com/sharer.php?u=https://www.cayzlh.com/2019/01/18/d419173e.html"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://twitter.com/share?url=https://www.cayzlh.com/2019/01/18/d419173e.html&text=Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.linkedin.com/shareArticle?url=https://www.cayzlh.com/2019/01/18/d419173e.html&title=Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://pinterest.com/pin/create/bookmarklet/?url=https://www.cayzlh.com/2019/01/18/d419173e.html&is_video=false&description=Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue&body=Check out this article: https://www.cayzlh.com/2019/01/18/d419173e.html"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://getpocket.com/save?url=https://www.cayzlh.com/2019/01/18/d419173e.html&title=Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://reddit.com/submit?url=https://www.cayzlh.com/2019/01/18/d419173e.html&title=Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.stumbleupon.com/submit?url=https://www.cayzlh.com/2019/01/18/d419173e.html&title=Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://digg.com/submit?url=https://www.cayzlh.com/2019/01/18/d419173e.html&title=Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.tumblr.com/share/link?url=https://www.cayzlh.com/2019/01/18/d419173e.html&name=Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://news.ycombinator.com/submitlink?u=https://www.cayzlh.com/2019/01/18/d419173e.html&t=Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97"><span class="toc-number">1.</span> <span class="toc-text">é˜»å¡é˜Ÿåˆ—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BlockingQueue%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">2.</span> <span class="toc-text">BlockingQueueçš„ä½¿ç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BlockingQueue%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">3.</span> <span class="toc-text">BlockingQueueçš„æ–¹æ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BlockingQueue%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="toc-number">4.</span> <span class="toc-text">BlockingQueueå®ç°ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ArrayBlockingQueue"><span class="toc-number">4.1.</span> <span class="toc-text">ArrayBlockingQueue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DelayQueue"><span class="toc-number">4.2.</span> <span class="toc-text">DelayQueue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LinkedBlockingQueue"><span class="toc-number">4.3.</span> <span class="toc-text">LinkedBlockingQueue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PriorityBlockingQueue"><span class="toc-number">4.4.</span> <span class="toc-text">PriorityBlockingQueue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SynchronousQueue"><span class="toc-number">4.5.</span> <span class="toc-text">SynchronousQueue</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Java-BlockingQueue-Example"><span class="toc-number">5.</span> <span class="toc-text">Java BlockingQueue Example</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Producer"><span class="toc-number">5.1.</span> <span class="toc-text">Producer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Consumer"><span class="toc-number">5.2.</span> <span class="toc-text">Consumer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Example"><span class="toc-number">5.3.</span> <span class="toc-text">Example</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">ğŸ³Antä¸¶</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-01-18T09:24:44.000Z" itemprop="datePublished">2019-01-18</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/blog/categories/Java/">Java</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/blog/tags/Java/" rel="tag">Java</a>, <a class="tag-link-link" href="/blog/tags/concurrent/" rel="tag">concurrent</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <blockquote>
<p>é˜»å¡é˜Ÿåˆ—æ˜¯ä¸€ç§é˜Ÿåˆ—ï¼Œä¸€ç§å¯ä»¥åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œå¹¶ä¸”æ”¯æŒé˜»å¡ç­‰å¾…çš„é˜Ÿåˆ—ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé˜»å¡é˜Ÿåˆ—å’Œä¸€èˆ¬çš„é˜Ÿåˆ—çš„åŒºåˆ«å°±åœ¨äºï¼š</p>
<ul>
<li>å¤šçº¿ç¨‹ç¯å¢ƒæ”¯æŒï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥å®‰å…¨çš„è®¿é—®é˜Ÿåˆ—</li>
<li>æ”¯æŒç”Ÿäº§å’Œæ¶ˆè´¹ç­‰å¾…ï¼Œå¤šä¸ªçº¿ç¨‹ä¹‹é—´äº’ç›¸é…åˆï¼Œå½“é˜Ÿåˆ—ä¸ºç©ºçš„æ—¶å€™ï¼Œæ¶ˆè´¹çº¿ç¨‹ä¼šé˜»å¡ç­‰å¾…é˜Ÿåˆ—ä¸ä¸ºç©ºï¼›å½“é˜Ÿåˆ—æ»¡äº†çš„æ—¶å€™ï¼Œç”Ÿäº§çº¿ ç¨‹å°±ä¼šé˜»å¡ç›´åˆ°é˜Ÿåˆ—ä¸æ»¡ã€‚</li>
</ul>
</blockquote>
<h2 id="é˜»å¡é˜Ÿåˆ—"><a href="#é˜»å¡é˜Ÿåˆ—" class="headerlink" title="é˜»å¡é˜Ÿåˆ—"></a>é˜»å¡é˜Ÿåˆ—</h2><p>é˜»å¡é˜Ÿåˆ—åœ¨<code>Java</code>ä¸­çš„ä¸€ç§å…¸å‹ä½¿ç”¨åœºæ™¯æ˜¯çº¿ç¨‹æ± ï¼Œåœ¨çº¿ç¨‹æ± ä¸­ï¼Œå½“æäº¤çš„ä»»åŠ¡ä¸èƒ½ç«‹å³</p>
<p>å¾—åˆ°æ‰§è¡Œçš„æ—¶å€™ï¼Œçº¿ç¨‹æ± å°±ä¼šå°†æäº¤çš„ä»»åŠ¡æ”¾åˆ°ä¸€ä¸ªé˜»å¡é˜Ÿåˆ—ä¸­æ¥ã€‚æ¯”å¦‚ä¸‹é¢çš„ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newFixedThreadPool</span><span class="params">(<span class="keyword">int</span> nThreads)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ThreadPoolExecutor(nThreads, nThreads,</span><br><span class="line">                                  <span class="number">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">                                  <span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>newFixedThreadPool</code>ä½¿ç”¨å¯<code>LinkedBlockingQueue</code>è¿™ç§é˜»å¡é˜Ÿåˆ—ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newCachedThreadPool</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ThreadPoolExecutor(<span class="number">0</span>, Integer.MAX_VALUE,</span><br><span class="line">                                  <span class="number">60L</span>, TimeUnit.SECONDS,</span><br><span class="line">                                  <span class="keyword">new</span> SynchronousQueue&lt;Runnable&gt;());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>newCachedThreadPoolä½¿ç”¨äº†SynchronousQueueè¿™ç§é˜Ÿåˆ—ï¼Œè¿™ç§é˜Ÿåˆ—çš„ç‰¹ç‚¹æ˜¯ä¸ç¼“å­˜æ•°æ®ï¼Œè€Œæ˜¯ç¼“å­˜çº¿ç¨‹ï¼Œçº¿ç¨‹åˆ†ä¸ºç”Ÿäº§è€…çº¿ç¨‹å’Œæ¶ˆè´¹è€…çº¿ç¨‹ï¼Œä¸€ä¸ªç”Ÿäº§è€…çº¿ç¨‹å’Œä¸€ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹æ˜¯äº’è¡¥çš„ï¼Œå½“ä¸€ä¸ªç”Ÿäº§è€…çº¿ç¨‹é‡åˆ°ä¸€ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹çš„æ—¶å€™å°±ä¼šç›´æ¥è¿›è¡Œæ•°æ®äº¤æ¢ï¼Œæ‰€ä»¥è¿™ç§é˜Ÿåˆ—çš„æŠ€æœ¯ç‚¹æ¯”è¾ƒé«˜ï¼Œç†è§£èµ·æ¥éš¾åº¦è¾ƒå¤§ã€‚ä¸€ä¸ªçº¿ç¨‹åªèƒ½ç¼“å­˜ä¸€ä¸ªæ•°æ®ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹æ’å…¥æ•°æ®ä¹‹åå°±ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°å¦å¤–ä¸€ä¸ªçº¿ç¨‹æ¶ˆè´¹äº†å…¶ä¸­çš„æ•°æ®ã€‚</p>
<p>é˜»å¡é˜Ÿåˆ—è¿˜æä¾›äº†å…¶ä»–ç±»å‹çš„é˜Ÿåˆ—ï¼ŒåŒ…æ‹¬åŒç«¯é˜»å¡é˜Ÿåˆ—ï¼Œå»¶æ—¶é˜»å¡é˜Ÿåˆ—ï¼Œå»¶æ—¶é˜»å¡é˜Ÿåˆ—çš„ä½¿ç”¨å¯ä»¥åœ¨newScheduledThreadPoolä¸­æ‰¾åˆ°ï¼ŒnewScheduledThreadPoolé‡Œé¢ä½¿ç”¨å»¶æ—¶é˜»å¡é˜Ÿåˆ—æ¥è°ƒåº¦å‘¨æœŸæ€§ä»»åŠ¡æ‰§è¡Œã€‚</p>
<p>ä¸‹é¢å±•ç¤ºçš„æ˜¯BlockingQueueæä¾›çš„ä¸€äº›æ–¹æ³•ï¼š</p>
<p><img src="https://github.com/cayzlh/git-img-repository/raw/master/blog/2019/01/18/2.png" alt="BlockingQueue"></p>
<h2 id="BlockingQueueçš„ä½¿ç”¨"><a href="#BlockingQueueçš„ä½¿ç”¨" class="headerlink" title="BlockingQueueçš„ä½¿ç”¨"></a>BlockingQueueçš„ä½¿ç”¨</h2><p><code>BlockingQueue</code>é€šå¸¸ç”¨äºåœ¨çº¿ç¨‹ä¸Šç”Ÿæˆå¦ä¸€ä¸ªçº¿ç¨‹æ¶ˆè€—çš„å¯¹è±¡ã€‚ä¸‹å›¾å±•ç¤ºè¿™ä¸ªè¿‡ç¨‹ï¼š</p>
<p><img src="https://github.com/cayzlh/git-img-repository/raw/master/blog/2019/01/18/1.png" alt="BlockingQueue"></p>
<p>ç”Ÿæˆçº¿ç¨‹å°†ç»§ç»­ç”Ÿæˆæ–°å¯¹è±¡å¹¶å°†å®ƒä»¬æ’å…¥é˜Ÿåˆ—ï¼Œç›´åˆ°é˜Ÿåˆ—è¾¾åˆ°å®ƒå¯ä»¥åŒ…å«çš„å†…å®¹çš„æŸä¸ªä¸Šé™ã€‚æ¢å¥è¯è¯´ï¼Œè¿™æ˜¯é™åˆ¶ã€‚å¦‚æœé˜»å¡é˜Ÿåˆ—è¾¾åˆ°å…¶ä¸Šé™ï¼Œåˆ™åœ¨å°è¯•æ’å…¥æ–°å¯¹è±¡æ—¶ä¼šé˜»æ­¢ç”Ÿæˆçº¿ç¨‹ã€‚å®ƒä¸€ç›´è¢«é˜»å¡ï¼Œç›´åˆ°æ¶ˆè´¹çº¿ç¨‹å°†ä¸€ä¸ªå¯¹è±¡ä»é˜Ÿåˆ—ä¸­å–å‡ºã€‚</p>
<p>æ¶ˆè´¹çº¿ç¨‹ä¸æ–­å°†å¯¹è±¡ä»é˜»å¡é˜Ÿåˆ—ä¸­å–å‡ºå¹¶å¤„ç†å®ƒä»¬ã€‚å¦‚æœæ¶ˆè´¹çº¿ç¨‹è¯•å›¾å°†å¯¹è±¡ä»ç©ºé˜Ÿåˆ—ä¸­å–å‡ºï¼Œåˆ™æ¶ˆè€—çº¿ç¨‹å°†è¢«é˜»å¡ï¼Œç›´åˆ°ç”Ÿæˆçº¿ç¨‹å°†å¯¹è±¡æ”¾å…¥é˜Ÿåˆ—ã€‚</p>
<h2 id="BlockingQueueçš„æ–¹æ³•"><a href="#BlockingQueueçš„æ–¹æ³•" class="headerlink" title="BlockingQueueçš„æ–¹æ³•"></a>BlockingQueueçš„æ–¹æ³•</h2><p>BlockingQueueæœ‰4ç»„ä¸åŒçš„æ–¹æ³•ç”¨äºæ’å…¥ï¼Œåˆ é™¤å’Œæ£€æŸ¥é˜Ÿåˆ—ä¸­çš„å…ƒç´ ã€‚å¦‚æœä¸èƒ½ç«‹å³æ‰§è¡Œæ‰€è¯·æ±‚çš„æ“ä½œï¼Œåˆ™æ¯ç»„æ–¹æ³•çš„è¡Œä¸ºéƒ½ä¸åŒã€‚</p>
<table>
<thead>
<tr>
<th>æ“ä½œç±»å‹</th>
<th>Throws Exception</th>
<th>Special Value</th>
<th>Blocks</th>
<th>Times Out</th>
</tr>
</thead>
<tbody><tr>
<td>æ’å…¥</td>
<td>add(o)</td>
<td>offer(o)</td>
<td>put(o)</td>
<td>offer(o, timeout, timeunit)</td>
</tr>
<tr>
<td>å–å‡ºï¼ˆåˆ é™¤ï¼‰</td>
<td>remove(o)</td>
<td>poll()</td>
<td>take()</td>
<td>poll(timeout, timeunit)</td>
</tr>
<tr>
<td>æ£€æŸ¥</td>
<td>element()</td>
<td>peek()</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>å››ç§æ“ä½œçš„å«ä¹‰ï¼š</p>
<ul>
<li><code>Throws Exception</code>ï¼š å¦‚æœæ— æ³•ç«‹å³å°è¯•æ“ä½œï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚ </li>
<li><code>Special Value</code>ï¼š å¦‚æœæ— æ³•ç«‹å³å°è¯•æ“ä½œï¼Œåˆ™è¿”å›ç‰¹æ®Šå€¼ï¼ˆé€šå¸¸ä¸ºtrue / falseï¼‰ã€‚ </li>
<li><code>Blocks</code>ï¼š å¦‚æœæ— æ³•ç«‹å³æ‰§è¡Œå°è¯•çš„æ“ä½œï¼Œåˆ™æ–¹æ³•è°ƒç”¨å°†é˜»å¡ç›´åˆ°å®ƒä¸ºæ­¢ã€‚ </li>
<li><code>Times Out</code>ï¼š å¦‚æœæ— æ³•ç«‹å³æ‰§è¡Œå°è¯•çš„æ“ä½œï¼Œåˆ™æ–¹æ³•è°ƒç”¨å°†é˜»å¡ç›´åˆ°å®ƒï¼Œä½†ç­‰å¾…ä¸è¶…è¿‡ç»™å®šçš„è¶…æ—¶ã€‚è¿”å›ä¸€ä¸ªç‰¹æ®Šå€¼ï¼Œå‘ŠçŸ¥æ“ä½œæ˜¯å¦æˆåŠŸï¼ˆé€šå¸¸ä¸ºtrue / falseï¼‰ã€‚</li>
</ul>
<blockquote>
<p>æ— æ³•åœ¨<code>BlockingQueue</code>ä¸­æ’å…¥<code>null</code>ã€‚å¦‚æœæ‚¨å°è¯•æ’å…¥<code>null</code>ï¼Œåˆ™<code>BlockingQueue</code>å°†æŠ›å‡º<code>NullPointerException</code>ã€‚</p>
</blockquote>
<p>å¯ä»¥è®¿é—®<code>BlockingQueue</code>ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œè€Œä¸ä»…ä»…æ˜¯å¼€å¤´å’Œç»“å°¾çš„å…ƒç´ ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨å·²æ’é˜Ÿå¯¹è±¡è¿›è¡Œå¤„ç†ï¼Œä½†æ‚¨çš„åº”ç”¨ç¨‹åºå†³å®šå–æ¶ˆå®ƒã€‚ç„¶åå¯ä»¥è°ƒç”¨<code>remove(o)</code>åˆ é™¤é˜Ÿåˆ—ä¸­çš„ç‰¹å®šå¯¹è±¡ã€‚ä½†æ˜¯ï¼Œè¿™ä¸æ˜¯éå¸¸æœ‰æ•ˆï¼Œæ‰€ä»¥é™¤éä½ çœŸçš„éœ€è¦ï¼Œå¦åˆ™ä½ ä¸åº”è¯¥ä½¿ç”¨è¿™äº›<code>Collection</code>æ–¹æ³•ã€‚</p>
<h2 id="BlockingQueueå®ç°ç±»"><a href="#BlockingQueueå®ç°ç±»" class="headerlink" title="BlockingQueueå®ç°ç±»"></a>BlockingQueueå®ç°ç±»</h2><p><code>BlockingQueue</code>æ˜¯ä¸€ä¸ªæ¥å£ï¼Œéœ€è¦é€šè¿‡å®ƒçš„å®ç°ç±»æ¥ä½¿ç”¨å®ƒï¼Œ<code>BlockingQueue</code>æœ‰ä»¥ä¸‹å®ç°ç±»ï¼š</p>
<p><img src="https://github.com/cayzlh/git-img-repository/raw/master/blog/2019/01/18/3.png" alt="BlockingQueue Implementations"></p>
<h3 id="ArrayBlockingQueue"><a href="#ArrayBlockingQueue" class="headerlink" title="ArrayBlockingQueue"></a>ArrayBlockingQueue</h3><p><code>ArrayBlockingQueue</code>æ˜¯ä¸€ä¸ªæœ‰ç•Œçš„é˜»å¡é˜Ÿåˆ—ï¼Œå®ƒå°†å…ƒç´ å­˜å‚¨åœ¨æ•°ç»„å†…éƒ¨ã€‚å®ƒæœ‰ç•Œæ„å‘³ç€å®ƒæ— æ³•å­˜å‚¨æ— é™é‡çš„å…ƒç´ ã€‚å®ƒå¯ä»¥åŒæ—¶å­˜å‚¨çš„å…ƒç´ æ•°é‡æœ‰ä¸€ä¸ªä¸Šé™ã€‚åœ¨å®ä¾‹åŒ–æ—¶è®¾ç½®ä¸Šé™ï¼Œä¹‹åæ— æ³•æ›´æ”¹ã€‚</p>
<p><code>ArrayBlockingQueue</code>ä»¥<code>FIFO</code>ï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰é¡ºåºåœ¨å†…éƒ¨å­˜å‚¨å…ƒç´ ã€‚é˜Ÿåˆ—çš„å¤´éƒ¨æ˜¯é˜Ÿåˆ—ä¸­æœ€é•¿æ—¶é—´çš„å…ƒç´ ï¼Œé˜Ÿåˆ—çš„å°¾éƒ¨æ˜¯é˜Ÿåˆ—ä¸­æœ€çŸ­æ—¶é—´çš„å…ƒç´ ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å¦‚ä½•å®ä¾‹åŒ–å’Œä½¿ç”¨<code>ArrayBlockingQueue</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">BlockingQueue queue = <span class="keyword">new</span> ArrayBlockingQueue(<span class="number">1024</span>);</span><br><span class="line"></span><br><span class="line">queue.put(<span class="string">&quot;1&quot;</span>);</span><br><span class="line"></span><br><span class="line">Object object = queue.take();</span><br></pre></td></tr></table></figure>
<h3 id="DelayQueue"><a href="#DelayQueue" class="headerlink" title="DelayQueue"></a>DelayQueue</h3><p><code>DelayQueue</code>åœ¨å†…éƒ¨é˜»æ­¢å…ƒç´ ï¼Œç›´åˆ°æŸä¸ªå»¶è¿Ÿåˆ°æœŸã€‚å…ƒç´ å¿…é¡»å®ç°<code>java.util.concurrent.Delayed</code>æ¥å£ã€‚ä»¥ä¸‹æ˜¯è¯¥æ¥å£çš„å®šä¹‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Delayed</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&lt;<span class="title">Delayed</span>&lt; </span>&#123;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getDelay</span><span class="params">(TimeUnit timeUnit)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œå°±æ˜¯è¦è·å–æ¶ˆè´¹å»¶æ—¶ã€‚</p>
<p>å»¶æ—¶é˜»å¡é˜Ÿåˆ—ä½¿ç”¨äº†ä¼˜å…ˆé˜»å¡é˜Ÿåˆ—æ¥å­˜å‚¨æ•°æ®ï¼Œæ•°æ®çš„è·å–æ˜¯æœ‰ä¼˜å…ˆçº§çš„ï¼Œè¿™ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œåœ¨è¿™ç‚¹ä¸Šï¼Œæˆ‘ä»¬åº”è¯¥å’Œjavaçš„çº¿ç¨‹æ± çš„è°ƒåº¦çº¿ç¨‹æ± çš„å®ç°è”ç³»èµ·æ¥ï¼Œåœ¨javaçš„è°ƒåº¦çº¿ç¨‹æ± çš„å®ç°ä¸Šï¼Œä¹Ÿä½¿ç”¨äº†å»¶æ—¶é˜Ÿåˆ—ï¼Œè€Œä¼˜å…ˆçº§é˜Ÿåˆ—å¯ä»¥ä¿è¯çº¿ç¨‹æ± è°ƒåº¦çš„ä»»åŠ¡éƒ½æ˜¯æ ¹æ®æ—¶é—´ä¼˜å…ˆçº§è¢«è°ƒåº¦çš„ã€‚takeæ–¹æ³•é¦–å…ˆä»ä¼˜å…ˆé˜Ÿåˆ—ä¸­è·å–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œç„¶åè¯¢é—®æ˜¯å¦éœ€è¦å»¶æ—¶ï¼Œå¦‚æœä¸éœ€è¦ï¼Œåˆ™ç›´æ¥è¿”å›ï¼Œå¦åˆ™å»¶æ—¶è®¾å®šçš„æ—¶é—´ä¹‹åå†è¿”å›ã€‚</p>
<p>Exampleï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DelayQueueExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        DelayQueue queue = <span class="keyword">new</span> DelayQueue();</span><br><span class="line"></span><br><span class="line">        Delayed element1 = <span class="keyword">new</span> DelayedElement();</span><br><span class="line"></span><br><span class="line">        queue.put(element1);</span><br><span class="line"></span><br><span class="line">        Delayed element2 = queue.take();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="LinkedBlockingQueue"><a href="#LinkedBlockingQueue" class="headerlink" title="LinkedBlockingQueue"></a>LinkedBlockingQueue</h3><p><code>LinkedBlockingQueue</code>ä½¿ç”¨é“¾è¡¨æ¥ä½œä¸ºé˜Ÿåˆ—çš„æ•°æ®ç»“æ„ï¼Œä¸‹é¢å°±æ˜¯é“¾è¡¨èŠ‚ç‚¹çš„æ•°æ®ç»“æ„ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">        E item;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * One of:</span></span><br><span class="line"><span class="comment">     * - the real successor Node</span></span><br><span class="line"><span class="comment">     * - this Node, meaning the successor is head.next</span></span><br><span class="line"><span class="comment">     * - null, meaning there is no successor (this is the last node)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Node&lt;E&gt; next;</span><br><span class="line"></span><br><span class="line">    Node(E x) &#123; item = x; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>LinkedBlockingQueue</code>å°†å…ƒç´ ä¿ç•™åœ¨é“¾æ¥ç»“æ„ï¼ˆé“¾æ¥èŠ‚ç‚¹ï¼‰å†…éƒ¨ã€‚å¦‚æœéœ€è¦ï¼Œè¯¥è¿æ¥ç»“æ„å¯ä»»é€‰åœ°å…·æœ‰ä¸Šé™ã€‚å¦‚æœæœªæŒ‡å®šä¸Šé™ï¼Œåˆ™ä½¿ç”¨<code>Integer.MAX_VALUE</code>ä½œä¸ºä¸Šé™ã€‚</p>
<p><code>LinkedBlockingQueue</code>åœ¨å†…éƒ¨ä»¥<code>FIFO</code>ï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰é¡ºåºå­˜å‚¨å…ƒç´ ã€‚é˜Ÿåˆ—çš„å¤´éƒ¨æ˜¯é˜Ÿåˆ—ä¸­æœ€é•¿æ—¶é—´çš„å…ƒç´ ï¼Œé˜Ÿåˆ—çš„å°¾éƒ¨æ˜¯é˜Ÿåˆ—ä¸­æœ€çŸ­æ—¶é—´çš„å…ƒç´ ã€‚</p>
<p>Exampleï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">BlockingQueue&lt;String&gt; unbounded = <span class="keyword">new</span> LinkedBlockingQueue&lt;String&gt;();</span><br><span class="line">BlockingQueue&lt;String&gt; bounded   = <span class="keyword">new</span> LinkedBlockingQueue&lt;String&gt;(<span class="number">1024</span>);</span><br><span class="line"></span><br><span class="line">bounded.put(<span class="string">&quot;Value&quot;</span>);</span><br><span class="line"></span><br><span class="line">String value = bounded.take();</span><br></pre></td></tr></table></figure>
<h3 id="PriorityBlockingQueue"><a href="#PriorityBlockingQueue" class="headerlink" title="PriorityBlockingQueue"></a>PriorityBlockingQueue</h3><p><code>PriorityBlockingQueue</code>æ˜¯ä¸€ä¸ªæ— é™åˆ¶çš„å¹¶å‘é˜Ÿåˆ—ã€‚ å®ƒä½¿ç”¨ä¸<code>java.util.PriorityQueue</code>ç±»ç›¸åŒçš„æ’åºè§„åˆ™ã€‚ ä¸èƒ½å°†<code>null</code>æ’å…¥æ­¤é˜Ÿåˆ—ã€‚</p>
<p>æ’å…¥<code>PriorityBlockingQueue</code>çš„æ‰€æœ‰å…ƒç´ éƒ½å¿…é¡»å®ç°<code>java.lang.Comparable</code>æ¥å£ã€‚ å› æ­¤ï¼Œå…ƒç´ æ ¹æ®æ‚¨åœ¨<code>Comparable</code>å®ç°ä¸­å†³å®šçš„ä¼˜å…ˆçº§è¿›è¡Œæ’åºã€‚</p>
<blockquote>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<code>PriorityBlockingQueue</code>ä¸ä¼šå¯¹å…·æœ‰ç›¸åŒä¼˜å…ˆçº§çš„å…ƒç´ å¼ºåˆ¶æ‰§è¡Œä»»ä½•ç‰¹å®šè¡Œä¸ºï¼ˆ<code>compareï¼ˆï¼‰== 0</code>ï¼‰ã€‚</p>
<p>å¦‚æœä»<code>PriorityBlockingQueue</code>è·å–<code>Iterator</code>ï¼Œ<code>Iterator</code>ä¸ä¿è¯æŒ‰ä¼˜å…ˆçº§é¡ºåºè¿­ä»£å…ƒç´ ã€‚</p>
</blockquote>
<p>Exampleï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">BlockingQueue queue   = <span class="keyword">new</span> PriorityBlockingQueue();</span><br><span class="line"></span><br><span class="line"><span class="comment">//String implements java.lang.Comparable</span></span><br><span class="line">queue.put(<span class="string">&quot;Value&quot;</span>);</span><br><span class="line"></span><br><span class="line">String value = queue.take();</span><br></pre></td></tr></table></figure>
<h3 id="SynchronousQueue"><a href="#SynchronousQueue" class="headerlink" title="SynchronousQueue"></a>SynchronousQueue</h3><p><code>SynchronousQueue</code>æ˜¯ä¸€ä¸ªå†…éƒ¨åªèƒ½åŒ…å«å•ä¸ªå…ƒç´ çš„é˜Ÿåˆ—ã€‚ å°†å…ƒç´ æ’å…¥é˜Ÿåˆ—çš„çº¿ç¨‹è¢«é˜»å¡ï¼Œç›´åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ä»é˜Ÿåˆ—ä¸­è·å–è¯¥å…ƒç´ ã€‚ åŒæ ·ï¼Œå¦‚æœçº¿ç¨‹å°è¯•è·å–å…ƒç´ å¹¶ä¸”å½“å‰ä¸å­˜åœ¨ä»»ä½•å…ƒç´ ï¼Œåˆ™è¯¥çº¿ç¨‹å°†è¢«é˜»å¡ï¼Œç›´åˆ°çº¿ç¨‹å°†å…ƒç´ æ’å…¥é˜Ÿåˆ—ã€‚æ˜¯æœ€ä¸ºå¤æ‚çš„é˜»å¡é˜Ÿåˆ—ã€‚</p>
<p>ä»»ä½•æ’å…¥æ“ä½œéƒ½éœ€è¦ç­‰å¾…å…¶ä»–çº¿ç¨‹æ¥æ¶ˆè´¹ï¼Œå¦åˆ™å°±ä¼šé˜»å¡ç­‰å¾…ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç”Ÿäº§çº¿ç¨‹ç”Ÿäº§å‡ºä¸€æ¡æ•°æ®ä¹‹åå°±è¦ç­‰å¾…æ¶ˆè´¹è€…çº¿ç¨‹æ¥å°†å…¶æ¶ˆè´¹æ‰ï¼Œæ‰èƒ½ç»§ç»­ç”Ÿäº§æ•°æ®ï¼Œå¦åˆ™å°±ä¼šé˜»å¡ç­‰å¾…æ¶ˆè´¹ã€‚é˜Ÿåˆ—ä¸­ä¼šæŠŠåˆ°æ¥çš„çº¿ç¨‹ç¼“å­˜èµ·æ¥ï¼Œå½“ç„¶ä¼šè¿›è¡Œä¸€äº›æ“ä½œï¼Œä¸‹é¢æ˜¯å¤§æ¦‚çš„ç®—æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>ã€é˜Ÿåˆ—åˆå§‹åŒ–ä¸º<span class="keyword">null</span></span><br><span class="line"><span class="number">2</span>ã€å½“ä¸€ä¸ªçº¿ç¨‹è¾¾åˆ°ä¹‹åï¼Œå¦‚æœé˜Ÿåˆ—ä¸º<span class="keyword">null</span>ï¼Œåˆ™å°†è¯¥çº¿ç¨‹æ”¾åˆ°é˜Ÿåˆ—ä¸­å»ï¼Œå¦åˆ™ï¼Œåˆ¤æ–­é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯å¦å’Œå½“å‰åˆ°è¾¾çš„å…ƒç´ </span><br><span class="line">åŒ¹é…ï¼Œå¦‚æœåŒ¹é…ï¼Œé‚£ä¹ˆä¸¤ä¸ªçº¿ç¨‹çš„æ•°æ®äº¤æ˜“å®Œæˆï¼Œå¦åˆ™ä¹Ÿå°†æ–°åˆ°è¾¾çš„çº¿ç¨‹æ•°æ®ç¼“å­˜åˆ°é˜Ÿåˆ—ä¸­ã€‚</span><br></pre></td></tr></table></figure>
<p><code>SynchronousQueue</code>é€šè¿‡ä½¿ç”¨<code>Transferer</code>ç±»çš„<code>transfer(E e, boolean timed, long nanos)</code>æ–¹æ³•æ¥å®Œæˆæ•°æ®äº¤æ˜“æ“ä½œï¼Œæ ¹æ®<code>fair</code>æ¨¡å¼å’Œ<code>non-fair</code>æ¨¡å¼æœ‰ä¸¤ç§ç±»å‹çš„<code>Transferer</code>ï¼Œ<code>fair</code>æ¨¡å¼å¯¹åº”äº<code>TransferQueue</code>ï¼Œ<code>non-fair</code>æ¨¡å¼å¯¹åº”<code>TransferStack</code>ã€‚</p>
<h2 id="Java-BlockingQueue-Example"><a href="#Java-BlockingQueue-Example" class="headerlink" title="Java BlockingQueue Example"></a>Java BlockingQueue Example</h2><p>è¿™æ˜¯ä¸€ä¸ª<code>Java BlockingQueue</code>ç¤ºä¾‹ã€‚è¯¥ç¤ºä¾‹ä½¿ç”¨<code>BlockingQueue</code>æ¥å£çš„<code>ArrayBlockingQueue</code>å®ç°ã€‚</p>
<p>å®ç°çš„æµç¨‹å¦‚ä¸‹ï¼Œ<code>BlockingQueueExample</code>ç±»åœ¨å•ç‹¬çš„çº¿ç¨‹ä¸­å¯åŠ¨<code>Producer</code>å’Œ<code>Consumer</code>ã€‚ <code>Producer</code>å°†å­—ç¬¦ä¸²æ’å…¥å…±äº«çš„<code>BlockingQueue</code>ï¼Œç„¶å<code>Consumer</code>å°†å®ƒä»¬å–å‡ºã€‚</p>
<h3 id="Producer"><a href="#Producer" class="headerlink" title="Producer"></a>Producer</h3><p>ç¼–å†™ç”Ÿäº§è€…ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Producer</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> BlockingQueue queue = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Producer</span><span class="params">(BlockingQueue queue)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.queue = queue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            queue.put(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">            queue.put(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">            queue.put(<span class="string">&quot;3&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Consumer"><a href="#Consumer" class="headerlink" title="Consumer"></a>Consumer</h3><p>æ¶ˆè´¹è€…ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> BlockingQueue queue = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Consumer</span><span class="params">(BlockingQueue queue)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.queue = queue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(queue.take());</span><br><span class="line">            System.out.println(queue.take());</span><br><span class="line">            System.out.println(queue.take());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>ç¤ºä¾‹ä»£ç (<code>main()</code>)ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArrayBlockingQueueExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        ArrayBlockingQueue queue = <span class="keyword">new</span> ArrayBlockingQueue(<span class="number">1024</span>);</span><br><span class="line">        Producer producer = <span class="keyword">new</span> Producer(queue);</span><br><span class="line">        Consumer consumer = <span class="keyword">new</span> Consumer(queue);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> Thread(producer).start();</span><br><span class="line">        <span class="keyword">new</span> Thread(consumer).start();</span><br><span class="line"></span><br><span class="line">        Thread.sleep(<span class="number">4000</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br></pre></td></tr></table></figure>

  </div>

  
    <div style="text-align:center;width:100%">
      <img src="https://cdn.jsdelivr.net/gh/cayzlh/git-img-repository@master/uPic/640-2.gif">
    </div>
  

  
    <div>
      <h4>ç‰ˆæƒå£°æ˜</h4>
      <pre>
        
        <strong>æœ¬æ–‡æ¥æºï¼š </strong><a href="https://www.cayzlh.com/blog" title="ğŸ³Antä¸¶" rel="noopener external nofollow noreferrer" target="_blank">https://www.cayzlh.com/blog</a>

        <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="https://www.cayzlh.com/2019/01/18/d419173e.html" title="/blog/Java%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97%E4%B9%8BBlockingQueue">https://www.cayzlh.com/2019/01/18/d419173e.html</a>

        <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>
        
          æ–‡ç« å†…å®¹ä»…ç”¨ä½œå­¦ä¹ å’Œåˆ†äº«ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„
        
      </pre>
    </div>
  

</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/blog/">Home</a></li>
        
          <li><a href="/blog/archives/">Articles</a></li>
        
          <li><a href="/blog/about/">About</a></li>
        
          <li><a href="/blog/search/">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97"><span class="toc-number">1.</span> <span class="toc-text">é˜»å¡é˜Ÿåˆ—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BlockingQueue%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">2.</span> <span class="toc-text">BlockingQueueçš„ä½¿ç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BlockingQueue%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">3.</span> <span class="toc-text">BlockingQueueçš„æ–¹æ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BlockingQueue%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="toc-number">4.</span> <span class="toc-text">BlockingQueueå®ç°ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ArrayBlockingQueue"><span class="toc-number">4.1.</span> <span class="toc-text">ArrayBlockingQueue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DelayQueue"><span class="toc-number">4.2.</span> <span class="toc-text">DelayQueue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LinkedBlockingQueue"><span class="toc-number">4.3.</span> <span class="toc-text">LinkedBlockingQueue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PriorityBlockingQueue"><span class="toc-number">4.4.</span> <span class="toc-text">PriorityBlockingQueue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SynchronousQueue"><span class="toc-number">4.5.</span> <span class="toc-text">SynchronousQueue</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Java-BlockingQueue-Example"><span class="toc-number">5.</span> <span class="toc-text">Java BlockingQueue Example</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Producer"><span class="toc-number">5.1.</span> <span class="toc-text">Producer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Consumer"><span class="toc-number">5.2.</span> <span class="toc-text">Consumer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Example"><span class="toc-number">5.3.</span> <span class="toc-text">Example</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.facebook.com/sharer.php?u=https://www.cayzlh.com/2019/01/18/d419173e.html"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://twitter.com/share?url=https://www.cayzlh.com/2019/01/18/d419173e.html&text=Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.linkedin.com/shareArticle?url=https://www.cayzlh.com/2019/01/18/d419173e.html&title=Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://pinterest.com/pin/create/bookmarklet/?url=https://www.cayzlh.com/2019/01/18/d419173e.html&is_video=false&description=Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue&body=Check out this article: https://www.cayzlh.com/2019/01/18/d419173e.html"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://getpocket.com/save?url=https://www.cayzlh.com/2019/01/18/d419173e.html&title=Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://reddit.com/submit?url=https://www.cayzlh.com/2019/01/18/d419173e.html&title=Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.stumbleupon.com/submit?url=https://www.cayzlh.com/2019/01/18/d419173e.html&title=Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://digg.com/submit?url=https://www.cayzlh.com/2019/01/18/d419173e.html&title=Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.tumblr.com/share/link?url=https://www.cayzlh.com/2019/01/18/d419173e.html&name=Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://news.ycombinator.com/submitlink?u=https://www.cayzlh.com/2019/01/18/d419173e.html&t=Javaé˜»å¡é˜Ÿåˆ—ä¹‹BlockingQueue"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
<!--        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>-->
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    CAYZLH &copy;
    
    
    2019-2021
    ç²¤ICPå¤‡20058712å·-1
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        
          <li><a href="/blog/tools/">tools</a></li>
        
          <li><a href="/blog/links/">links</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/blog/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/blog/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/blog/lib/jquery/jquery.min.js"></script>


<script src="/blog/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/blog/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/blog/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-129095667-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-129095667-1');
    </script>

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->


</body>
</html>
